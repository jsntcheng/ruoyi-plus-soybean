import{_ as _e,a as ve,b as Ke}from"./round-refresh-B0IUvXWI.js";import{d as X,ak as j,r as H,al as q,p as ye,a as se,q as he,am as ee,c as E,o as G,w as t,f as e,an as re,v as te,e as Q,ao as Be,b as ie,a3 as be,a4 as Me,h as a,s as ne,af as W,B as ae,g as F,t as V,$ as D,ap as ue,N as ge,R as de,ac as Z,as as Ae,i as Fe,z as Le,x as We,aa as Pe,G as ze,I as ke,ag as Ge,aq as Oe,A as Y,ar as me}from"./index-Z8DUt18u.js";import{f as Ve,g as qe}from"./business-CduYu0Mf.js";import{f as Ee,a as we,b as je,c as He,d as fe,e as Je,g as Qe}from"./role-DtxyGCST.js";import{_ as Xe,a as Ye,b as Ne,u as Ze}from"./auth-CEy-eMOu.js";import{u as et}from"./download-4Fcgw4rI.js";import{u as xe,a as Se}from"./table-xLscuIQ4.js";import{_ as tt}from"./status-switch.vue_vue_type_script_setup_true_lang-SMgoHDPQ.js";import{_ as De}from"./form-tip.vue_vue_type_script_setup_true_lang-8erTB2XS.js";import{e as at}from"./menu-Xcd0YzZ-.js";import{u as ce,a as Ie,b as oe,_ as Ue}from"./form-34oM_FHm.js";import{u as pe}from"./dict-D3hWHJVt.js";import{M as ot}from"./menu-tree-CifRtWYH.js";import{a as lt,b as nt,_ as Ce}from"./DataTable-s6EYq0ve.js";import{_ as le}from"./Space-CCrTpFrl.js";import{_ as Re}from"./Grid-tUpxGiRj.js";import{_ as st}from"./DatePicker-CLebrfbL.js";import{e as rt,g as it}from"./user-BD5iFoP8.js";import{_ as ut}from"./Tree-C1TOTihx.js";import{_ as dt}from"./table-row-check-alert-DOh9EzfL.js";import{_ as ct}from"./dict-tag.vue_vue_type_script_setup_true_lang-C3NRfqiy.js";import"./use-table-DjHicHPt.js";import"./dict-CTAJ1fRb.js";import"./index-DbR6TmJ_.js";import"./Alert-DUaZ8Sea.js";const pt={class:"flex-center"},mt=X({name:"RoleOperateDrawer",__name:"role-operate-drawer",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup($,{emit:P}){const y=$,R=P,w=H(null),h=q($,"visible"),{options:b}=pe("sys_normal_disable"),m=H([]),{loading:I,startLoading:K,endLoading:T}=ye(),{formRef:B,validate:k,restoreValidation:N}=ce(),{createRequiredRule:U}=Ie(),i=se(()=>({add:"新增角色",edit:"编辑角色"})[y.operateType]),n=he(s());function s(){return{menuIds:[],roleName:"",roleKey:"",roleSort:1,menuCheckStrictly:!0,status:"0",remark:""}}const g={roleId:U("角色ID不能为空"),roleName:U("角色名称不能为空"),roleKey:U("角色权限字符串不能为空"),status:U("角色状态不能为空")};async function v(){var l;if(m.value=[],n.menuIds=[],y.operateType==="add"){(l=w.value)==null||l.refresh(),Object.assign(n,s());return}if(y.operateType==="edit"&&y.rowData){K(),Object.assign(n,y.rowData);const{data:r,error:f}=await at(n.roleId);if(f)return;n.menuIds=r.checkedKeys,m.value=r.menus,T()}}function u(){h.value=!1}async function p(){var O,z;await k();const{roleId:l,roleName:r,roleKey:f,roleSort:S,menuCheckStrictly:x,status:L,remark:M}=n,A=(O=w.value)==null?void 0:O.getCheckedMenuIds();if(y.operateType==="add"){const{error:o}=await Ee({roleName:r,roleKey:f,roleSort:S,menuCheckStrictly:x,status:L,remark:M,menuIds:A});if(o)return}if(y.operateType==="edit"){const{error:o}=await we({roleId:l,roleName:r,roleKey:f,roleSort:S,menuCheckStrictly:x,status:L,remark:M,menuIds:A});if(o)return}(z=window.$message)==null||z.success(D("common.updateSuccess")),u(),R("submitted")}return ee(h,()=>{h.value&&(v(),N())}),(l,r)=>{const f=te,S=Ue,x=De,L=Be,M=nt,A=lt,O=oe,z=ae,o=le,d=re,_=ue;return G(),E(_,{show:h.value,"onUpdate:show":r[9]||(r[9]=c=>h.value=c),title:i.value,"display-directive":"show",width:800,class:"max-w-90%"},{default:t(()=>[e(d,{title:i.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[e(o,{size:16},{default:t(()=>[e(z,{onClick:u},{default:t(()=>[F(V(a(D)("common.cancel")),1)]),_:1}),e(z,{type:"primary",onClick:p},{default:t(()=>[F(V(a(D)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(O,{ref_key:"formRef",ref:B,model:n,rules:g},{default:t(()=>[e(S,{label:"角色名称",path:"roleName"},{default:t(()=>[e(f,{value:n.roleName,"onUpdate:value":r[0]||(r[0]=c=>n.roleName=c),placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),e(S,{path:"roleKey"},{label:t(()=>[Q("div",pt,[e(x,{content:"控制器中定义的权限字符，如：@SaCheckRole('admin')"}),r[10]||(r[10]=Q("span",{class:"pl-3px"},"权限字符",-1))])]),default:t(()=>[e(f,{value:n.roleKey,"onUpdate:value":r[1]||(r[1]=c=>n.roleKey=c),placeholder:"请输入权限字符"},null,8,["value"])]),_:1}),e(S,{label:"显示顺序",path:"roleSort"},{default:t(()=>[e(L,{value:n.roleSort,"onUpdate:value":r[2]||(r[2]=c=>n.roleSort=c),placeholder:"请输入显示顺序"},null,8,["value"])]),_:1}),e(S,{label:"角色状态",path:"status"},{default:t(()=>[e(A,{value:n.status,"onUpdate:value":r[3]||(r[3]=c=>n.status=c)},{default:t(()=>[(G(!0),ie(be,null,Me(a(b),c=>(G(),E(M,{key:c.value,value:c.value,label:c.label},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1}),e(S,{label:"菜单权限",path:"menuIds",class:"pr-24px"},{default:t(()=>[h.value?(G(),E(ot,{key:0,ref_key:"menuTreeRef",ref:w,"checked-keys":n.menuIds,"onUpdate:checkedKeys":r[4]||(r[4]=c=>n.menuIds=c),options:m.value,"onUpdate:options":r[5]||(r[5]=c=>m.value=c),cascade:n.menuCheckStrictly,"onUpdate:cascade":r[6]||(r[6]=c=>n.menuCheckStrictly=c),loading:a(I),"onUpdate:loading":r[7]||(r[7]=c=>W(I)?I.value=c:null),immediate:l.operateType==="add"},null,8,["checked-keys","options","cascade","loading","immediate"])):ne("",!0)]),_:1}),e(S,{label:"备注",path:"remark"},{default:t(()=>[e(f,{value:n.remark,"onUpdate:value":r[8]||(r[8]=c=>n.remark=c),rows:3,type:"textarea",placeholder:"请输入备注"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show","title"])}}}),ft=X({name:"RoleSearch",__name:"role-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup($,{emit:P}){const y=P,{formRef:R,validate:w,restoreValidation:h}=ce(),b=H(null),m=q($,"model"),{options:I}=pe("sys_normal_disable");async function K(){b.value=null,await h(),y("reset")}async function T(){var B;await w(),(B=b.value)!=null&&B.length&&(m.value.params.beginTime=`${b.value[0]} 00:00:00`,m.value.params.endTime=`${b.value[1]} 23:59:59`),y("search")}return(B,k)=>{const N=te,U=Ne,i=ge,n=st,s=_e,g=ae,v=ve,u=le,p=Re,l=oe,r=Ye,f=Xe,S=de;return G(),E(S,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(f,null,{default:t(()=>[e(r,{title:a(D)("common.search"),name:"user-search"},{default:t(()=>[e(l,{ref_key:"formRef",ref:R,model:m.value,"label-placement":"left","label-width":80},{default:t(()=>[e(p,{responsive:"screen","item-responsive":""},{default:t(()=>[e(U,{span:"24 s:12 m:6",label:"角色名称",path:"roleName",class:"pr-24px"},{default:t(()=>[e(N,{value:m.value.roleName,"onUpdate:value":k[0]||(k[0]=x=>m.value.roleName=x),placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),e(U,{span:"24 s:12 m:6",label:"权限字符",path:"roleKey",class:"pr-24px"},{default:t(()=>[e(N,{value:m.value.roleKey,"onUpdate:value":k[1]||(k[1]=x=>m.value.roleKey=x),placeholder:"请输入权限字符"},null,8,["value"])]),_:1}),e(U,{span:"24 s:12 m:6",label:"角色状态",path:"status",class:"pr-24px"},{default:t(()=>[e(i,{value:m.value.status,"onUpdate:value":k[2]||(k[2]=x=>m.value.status=x),placeholder:"请选择角色状态",options:a(I),clearable:""},null,8,["value","options"])]),_:1}),e(U,{span:"24 s:12 m:6",label:"创建时间",path:"createTime",class:"pr-24px"},{default:t(()=>[e(n,{"formatted-value":b.value,"onUpdate:formattedValue":k[3]||(k[3]=x=>b.value=x),"update-value-on-close":"",class:"w-full",type:"daterange","value-format":"yyyy-MM-dd",clearable:""},null,8,["formatted-value"])]),_:1}),e(U,{span:"24",class:"pr-24px"},{default:t(()=>[e(u,{class:"w-full",justify:"end"},{default:t(()=>[e(g,{onClick:K},{icon:t(()=>[e(s,{class:"text-icon"})]),default:t(()=>[F(" "+V(a(D)("common.reset")),1)]),_:1}),e(g,{type:"primary",ghost:"",onClick:T},{icon:t(()=>[e(v,{class:"text-icon"})]),default:t(()=>[F(" "+V(a(D)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1})]),_:1})}}}),_t={class:"w-full flex-col gap-12px"},vt={class:"w-full flex-center"},yt=X({name:"DeptTree",__name:"dept-tree",props:j({immediate:{type:Boolean,default:!0}},{value:{required:!1,default:[]},valueModifiers:{},options:{required:!1,default:[]},optionsModifiers:{},cascade:{type:Boolean,required:!1,default:!0},cascadeModifiers:{},loading:{type:Boolean,required:!1,default:!1},loadingModifiers:{}}),emits:["update:value","update:options","update:cascade","update:loading"],setup($,{expose:P}){const y=$,{bool:R}=Z(),{bool:w}=Z(),h=H([100]),b=H(null),m=q($,"value"),I=q($,"options"),K=q($,"cascade"),T=q($,"loading"),B=Ae();async function k(){T.value=!0;const{error:n,data:s}=await rt();n||(s?I.value=Array.isArray(s)?s:[s]:I.value=[],T.value=!1)}Fe(()=>{y.immediate&&k()}),ee([R,I],([n])=>{n?h.value=N(I.value):h.value=[100]});function N(n){const s=[];return n.forEach(g=>{g.id&&s.push(g.id),g.children&&Array.isArray(g.children)&&s.push(...N(g.children))}),s}function U(n){if(n){m.value=N(I.value);return}m.value=[]}function i(){var g;const n=[...m.value],s=(g=b.value)==null?void 0:g.getIndeterminateData();if(K.value){const v=s==null?void 0:s.keys.filter(u=>!(n!=null&&n.includes(String(u))));n==null||n.push(...v)}return n}return P({submit:i,refresh:k}),(n,s)=>{const g=Le,v=ut,u=We;return G(),ie("div",_t,[Q("div",vt,[e(g,{checked:a(R),"onUpdate:checked":s[0]||(s[0]=p=>W(R)?R.value=p:null),"checked-value":!0,"unchecked-value":!1},{default:t(()=>s[5]||(s[5]=[F("展开/折叠")])),_:1},8,["checked"]),e(g,{checked:a(w),"onUpdate:checked":[s[1]||(s[1]=p=>W(w)?w.value=p:null),U],"checked-value":!0,"unchecked-value":!1},{default:t(()=>s[6]||(s[6]=[F(" 全选/反选 ")])),_:1},8,["checked"]),e(g,{checked:K.value,"onUpdate:checked":s[2]||(s[2]=p=>K.value=p),"checked-value":!0,"unchecked-value":!1},{default:t(()=>s[7]||(s[7]=[F("父子联动")])),_:1},8,["checked"])]),e(u,{class:"resource h-full w-full py-6px pl-3px","content-class":"h-full",show:T.value},{default:t(()=>[e(v,Pe({ref_key:"deptTreeRef",ref:b,"checked-keys":m.value,"onUpdate:checkedKeys":s[3]||(s[3]=p=>m.value=p),"expanded-keys":h.value,"onUpdate:expandedKeys":s[4]||(s[4]=p=>h.value=p),multiple:"",checkable:"",selectable:!1,"key-field":"id","label-field":"label",data:I.value,cascade:K.value,loading:T.value,"virtual-scroll":"","check-strategy":K.value?"child":"all"},a(B)),null,16,["checked-keys","expanded-keys","data","cascade","loading","check-strategy"])]),_:1},8,["show"])])}}}),ht=ze(yt,[["__scopeId","data-v-03b743cc"]]),bt={class:"flex-center"},gt=X({name:"RoleDataScopeDrawer",__name:"role-data-scope-drawer",props:j({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup($,{emit:P}){const y=$,R=P,w=H(null),h=q($,"visible"),b=H([]),{loading:m,startLoading:I,endLoading:K}=ye(),{formRef:T,validate:B,restoreValidation:k}=ce(),{createRequiredRule:N}=Ie(),U=se(()=>"分配数据权限"),i=he(n());function n(){var p,l,r,f;return{roleId:(p=y.rowData)==null?void 0:p.roleId,roleName:(l=y.rowData)==null?void 0:l.roleName,roleKey:(r=y.rowData)==null?void 0:r.roleKey,roleSort:(f=y.rowData)==null?void 0:f.roleSort,deptIds:[],menuIds:[],deptCheckStrictly:!0,dataScope:"1"}}const s={dataScope:N("数据权限范围不能为空")};async function g(){if(I(),b.value=[],i.deptIds=[],y.rowData){Object.assign(i,y.rowData);const{error:p,data:l}=await je(y.rowData.roleId);if(p)return;b.value=l.depts,i.deptIds=l.checkedKeys}K()}function v(){h.value=!1}async function u(){var A;await B();const{roleId:p,roleName:l,roleKey:r,roleSort:f,dataScope:S,deptIds:x,menuIds:L}=i,{error:M}=await we({roleId:p,roleName:l,roleKey:r,roleSort:f,dataScope:S,deptIds:S==="2"?x:[],menuIds:L});M||((A=window.$message)==null||A.success(D("common.updateSuccess")),v(),R("submitted"))}return ee(h,()=>{h.value&&(g(),k())}),(p,l)=>{const r=te,f=Ue,S=De,x=ge,L=oe,M=ae,A=le,O=re,z=ue;return G(),E(z,{show:h.value,"onUpdate:show":l[7]||(l[7]=o=>h.value=o),title:U.value,"display-directive":"show",width:800,class:"max-w-90%"},{default:t(()=>[e(O,{title:U.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[e(A,{size:16},{default:t(()=>[e(M,{onClick:v},{default:t(()=>[F(V(a(D)("common.cancel")),1)]),_:1}),e(M,{type:"primary",onClick:u},{default:t(()=>[F(V(a(D)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(L,{ref_key:"formRef",ref:T,model:i,rules:s},{default:t(()=>[e(f,{label:"角色名称",path:"roleName"},{default:t(()=>[e(r,{value:i.roleName,"onUpdate:value":l[0]||(l[0]=o=>i.roleName=o),disabled:"",placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),e(f,{path:"roleKey"},{label:t(()=>[Q("div",bt,[e(S,{content:"控制器中定义的权限字符，如：@SaCheckRole('admin')"}),l[8]||(l[8]=Q("span",{class:"pl-3px"},"权限字符",-1))])]),default:t(()=>[e(r,{value:i.roleKey,"onUpdate:value":l[1]||(l[1]=o=>i.roleKey=o),disabled:"",placeholder:"请输入权限字符"},null,8,["value"])]),_:1}),e(f,{label:"权限范围",path:"dataScope"},{default:t(()=>[e(x,{value:i.dataScope,"onUpdate:value":l[2]||(l[2]=o=>i.dataScope=o),options:a(Ve)},null,8,["value","options"])]),_:1}),i.dataScope==="2"?(G(),E(f,{key:0,label:"数据权限",path:"deptIds",class:"pr-24px"},{default:t(()=>[h.value?(G(),E(ht,{key:0,ref_key:"deptTreeRef",ref:w,value:i.deptIds,"onUpdate:value":l[3]||(l[3]=o=>i.deptIds=o),options:b.value,"onUpdate:options":l[4]||(l[4]=o=>b.value=o),loading:a(m),"onUpdate:loading":l[5]||(l[5]=o=>W(m)?m.value=o:null),cascade:i.deptCheckStrictly,"onUpdate:cascade":l[6]||(l[6]=o=>i.deptCheckStrictly=o),immediate:!1},null,8,["value","options","loading","cascade"])):ne("",!0)]),_:1})):ne("",!0)]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show","title"])}}}),kt={class:"h-full flex-col-stretch gap-12px overflow-hidden lt-sm:overflow-auto"},wt=X({name:"RoleAuthUserDrawer",__name:"role-auth-user-drawer",props:j({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup($,{emit:P}){const y=$,R=P,w=q($,"visible"),h=ke(),b=se(()=>"分配用户权限");pe("sys_normal_disable");const{columns:m,data:I,getData:K,getDataByPage:T,loading:B,mobilePagination:k,searchParams:N,resetSearchParams:U}=xe({immediate:!1,apiFn:it,apiParams:{pageNum:1,pageSize:20,deptId:null,userName:null,nickName:null,phonenumber:null,status:null,params:{}},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:D("common.index"),align:"center",width:64},{key:"userName",title:"用户名称",align:"center",minWidth:120,ellipsis:!0},{key:"nickName",title:"用户昵称",align:"center",minWidth:120,ellipsis:!0},{key:"deptName",title:"部门",align:"center",minWidth:120,ellipsis:!0},{key:"phonenumber",title:"手机号码",align:"center",minWidth:120,ellipsis:!0},{key:"status",title:"状态",align:"center",minWidth:80,render(v){return e(ct,{size:"small",value:v.status,dictCode:"sys_normal_disable"},null)}},{key:"createTime",title:"创建时间",align:"center",minWidth:120}]}),{checkedRowKeys:i}=Se(I,K);async function n(){var u;i.value=[],T();const{data:v}=await He({roleId:(u=y.rowData)==null?void 0:u.roleId});i.value=(v==null?void 0:v.rows.map(p=>p.userId))||[]}function s(){w.value=!1}async function g(){var v;(v=window.$message)==null||v.success(D("common.updateSuccess")),s(),R("submitted")}return ee(w,()=>{w.value&&n()}),(v,u)=>{const p=te,l=Ne,r=_e,f=ae,S=ve,x=le,L=Re,M=oe,A=dt,O=Ce,z=de,o=re,d=ue;return G(),E(d,{show:w.value,"onUpdate:show":u[6]||(u[6]=_=>w.value=_),title:b.value,"display-directive":"show",width:1300,class:"max-w-90%","content-class":"h-full","wrapper-class":"h-full"},{default:t(()=>[e(o,{title:b.value,"native-scrollbar":!1,closable:"","body-class":"h-full","body-content-class":"h-full"},{footer:t(()=>[e(x,{size:16},{default:t(()=>[e(f,{onClick:s},{default:t(()=>[F(V(a(D)("common.cancel")),1)]),_:1}),e(f,{type:"primary",onClick:g},{default:t(()=>[F(V(a(D)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[Q("div",kt,[e(M,{model:a(N),"label-placement":"left","label-width":80},{default:t(()=>[e(L,{responsive:"screen","item-responsive":""},{default:t(()=>[e(l,{span:"24 s:12 m:8",label:"用户名称",path:"userName",class:"pr-24px"},{default:t(()=>[e(p,{value:a(N).userName,"onUpdate:value":u[0]||(u[0]=_=>a(N).userName=_),placeholder:"请输入用户名称"},null,8,["value"])]),_:1}),e(l,{span:"24 s:12 m:8",label:"用户昵称",path:"nickName",class:"pr-24px"},{default:t(()=>[e(p,{value:a(N).nickName,"onUpdate:value":u[1]||(u[1]=_=>a(N).nickName=_),placeholder:"请输入用户昵称"},null,8,["value"])]),_:1}),e(l,{span:"24 s:12 m:8",label:"手机号码",path:"phonenumber",class:"pr-24px"},{default:t(()=>[e(p,{value:a(N).phonenumber,"onUpdate:value":u[2]||(u[2]=_=>a(N).phonenumber=_),placeholder:"请输入手机号码"},null,8,["value"])]),_:1}),e(l,{span:"24 s:12 m:24",class:"pr-24px","show-feedback":!1},{default:t(()=>[e(x,{class:"w-full",justify:"end"},{default:t(()=>[e(f,{onClick:a(U)},{icon:t(()=>[e(r,{class:"text-icon"})]),default:t(()=>[F(" "+V(a(D)("common.reset")),1)]),_:1},8,["onClick"]),e(f,{type:"primary",ghost:"",onClick:u[3]||(u[3]=()=>a(T)())},{icon:t(()=>[e(S,{class:"text-icon"})]),default:t(()=>[F(" "+V(a(D)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),e(A,{"checked-row-keys":a(i),"onUpdate:checkedRowKeys":u[4]||(u[4]=_=>W(i)?i.value=_:null)},null,8,["checked-row-keys"]),e(z,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{default:t(()=>[e(O,{"checked-row-keys":a(i),"onUpdate:checkedRowKeys":u[5]||(u[5]=_=>W(i)?i.value=_:null),columns:a(m),data:a(I),size:"small","flex-height":!a(h).isMobile,"scroll-x":962,loading:a(B),remote:"","row-key":_=>_.userId,pagination:a(k),class:"h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])]),_:1},8,["title"])]),_:1},8,["show","title"])}}}),Nt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Jt=X({name:"system_role",__name:"index",setup($){const P=ke(),{download:y}=et(),{hasAuth:R}=Ze(),{bool:w,setTrue:h}=Z(!1),{bool:b,setTrue:m}=Z(!1),{columns:I,columnChecks:K,data:T,getData:B,getDataByPage:k,loading:N,mobilePagination:U,searchParams:i,resetSearchParams:n}=xe({apiFn:Je,apiParams:{pageNum:1,pageSize:10,roleName:null,roleKey:null,status:null,params:{}},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:D("common.index"),align:"center",width:64},{key:"roleName",title:"角色名称",align:"center",minWidth:120},{key:"roleKey",title:"角色权限字符串",align:"center",minWidth:120},{key:"roleSort",title:"显示顺序",align:"center",minWidth:120},{key:"dataScope",title:"数据范围",align:"center",minWidth:120,render:o=>e(Ge,{type:"info"},{default:()=>[qe[o.dataScope]]})},{key:"status",title:"角色状态",align:"center",minWidth:120,render(o){return e(tt,{value:o.status,"onUpdate:value":d=>o.status=d,disabled:o.roleId===1,info:o.roleKey,onSubmitted:(d,_)=>A(o,d,_)},null)}},{key:"createTime",title:"创建时间",align:"center",minWidth:120},{key:"operate",title:D("common.operate"),align:"center",width:220,render:o=>{if(o.roleId===1)return null;const d=()=>e(Y,{text:!0,type:"primary",icon:"material-symbols:drive-file-rename-outline-outline",tooltipContent:D("common.edit"),onClick:()=>L(o.roleId)},null),_=()=>e(Y,{text:!0,type:"primary",icon:"material-symbols:database",tooltipContent:"数据范围权限",onClick:()=>O(o)},null),c=()=>e(Y,{text:!0,type:"primary",icon:"material-symbols:assignment-ind-outline",tooltipContent:"分配用户",onClick:()=>z(o)},null),J=()=>e(Y,{text:!0,type:"error",icon:"material-symbols:delete-outline",tooltipContent:D("common.delete"),popconfirmContent:D("common.confirmDelete"),onPositiveClick:()=>x(o.roleId)},null),C=[];return R("system:role:edit")&&(C.push(d()),C.push(_()),C.push(c())),R("system:role:remove")&&C.push(J()),e("div",{class:"flex-center gap-8px"},[C.map((Te,$e)=>e(be,null,[$e!==0&&e(Oe,{vertical:!0},null),Te]))])}}]}),{drawerVisible:s,operateType:g,editingData:v,handleAdd:u,handleEdit:p,checkedRowKeys:l,onBatchDeleted:r,onDeleted:f}=Se(T,B);async function S(){const{error:o}=await fe(l.value);o||r()}async function x(o){const{error:d}=await fe([o]);d||f()}async function L(o){p("roleId",o)}async function M(){y("/system/role/export",i,`角色_${new Date().getTime()}.xlsx`)}async function A(o,d,_){var J;const{error:c}=await Qe({roleId:o.roleId,status:d});_(!c),c||((J=window.$message)==null||J.success("状态修改成功"),B())}function O(o){const d=T.value.find(_=>_.roleId===o.roleId)||null;v.value=me(d),h()}function z(o){const d=T.value.find(_=>_.roleId===o.roleId)||null;v.value=me(d),m()}return(o,d)=>{const _=Ke,c=Ce,J=de;return G(),ie("div",Nt,[e(ft,{model:a(i),"onUpdate:model":d[0]||(d[0]=C=>W(i)?i.value=C:null),onReset:a(n),onSearch:a(k)},null,8,["model","onReset","onSearch"]),e(J,{title:"角色列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(_,{columns:a(K),"onUpdate:columns":d[1]||(d[1]=C=>W(K)?K.value=C:null),"disabled-delete":a(l).length===0,loading:a(N),"show-add":a(R)("system:role:add"),"show-delete":a(R)("system:role:remove"),"show-export":a(R)("system:role:export"),onAdd:a(u),onDelete:S,onExport:M,onRefresh:a(B)},null,8,["columns","disabled-delete","loading","show-add","show-delete","show-export","onAdd","onRefresh"])]),default:t(()=>[e(c,{"checked-row-keys":a(l),"onUpdate:checkedRowKeys":d[2]||(d[2]=C=>W(l)?l.value=C:null),columns:a(I),data:a(T),size:"small","flex-height":!a(P).isMobile,"scroll-x":962,loading:a(N),remote:"","row-key":C=>C.roleId,pagination:a(U),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(mt,{visible:a(s),"onUpdate:visible":d[3]||(d[3]=C=>W(s)?s.value=C:null),"operate-type":a(g),"row-data":a(v),onSubmitted:a(k)},null,8,["visible","operate-type","row-data","onSubmitted"]),e(gt,{visible:a(w),"onUpdate:visible":d[4]||(d[4]=C=>W(w)?w.value=C:null),"row-data":a(v),onSubmitted:a(k)},null,8,["visible","row-data","onSubmitted"]),e(wt,{visible:a(b),"onUpdate:visible":d[5]||(d[5]=C=>W(b)?b.value=C:null),"row-data":a(v),onSubmitted:a(k)},null,8,["visible","row-data","onSubmitted"])]),_:1})])}}});export{Jt as default};
