import{d as b,U as S,n as B,u as C,p as L,r as T,i as k,b as R,o as q,e as o,V as I,h as E,W as J,t as N,X as P}from"./index-Z8DUt18u.js";const U={class:"fixed-center flex-col bg-layout"},V={class:"my-36px h-120px w-120px"},z={class:"text-28px text-primary font-500"},F=b({name:"social-callback",__name:"index",setup(A){const a=S(),c=B(),{routerPushByKey:i}=C(),{loading:p,startLoading:w,endLoading:r}=L(!0),y=a.query.code,n=a.query.state,f=a.query.source,l=n?JSON.parse(atob(n)):{},g=l.tenantId??"000000",u=l.domain??window.location.host,e=T("正在登录，请稍后......"),d=async()=>{var t;(t=window.$message)==null||t.success("登录成功"),e.value="登录成功，2s 后即将跳转至首页",setTimeout(()=>{e.value="登录成功，1s 后即将跳转至首页"},1e3),setTimeout(()=>{i("home")},1e3)},m=()=>{e.value="登录失败，2s 后即将跳转至登录页",setTimeout(()=>{e.value="登录失败，1s 后即将跳转至登录页"},1e3),setTimeout(()=>{i("login")},1e3)},_=async t=>{const{error:s}=await P({...t,clientId:"e5cd7e4891bf95d1d19206ce24a7b32e",grantType:"social"});if(s){m();return}await d(),r()},x=async t=>{try{await c.login(t),await d()}catch{m()}r()},v=async()=>{w();const t=window.location.host;if(u!==t){const h=new URL(window.location.href);h.host=u,window.location.href=h.toString();return}const s={socialCode:y,socialState:n,tenantId:g,source:f,grantType:"social"};c.isLogin?await _(s):await x(s)};return k(async()=>{await v()}),(t,s)=>(q(),R("div",U,[o("div",V,[o("div",{class:I(["relative h-full",{"animate-spin":E(p)}])},s[0]||(s[0]=[o("img",{src:J,width:"120"},null,-1)]),2)]),o("h2",z,N(e.value),1)]))}});export{F as default};
