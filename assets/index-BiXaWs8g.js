import{_ as E,a as V,b as ee}from"./dept-tree-select.vue_vue_type_script_setup_true_lang-BO9JZ0Qq.js";import{_ as te,a as oe,b as ne}from"./round-refresh-B0IUvXWI.js";import{aj as M,d as j,ak as W,al as z,a as ae,q as le,am as se,c as G,o as O,w as t,f as e,an as re,ao as de,v as H,B as L,g as A,t as F,h as n,$ as h,ap as ue,R as J,I as ie,b as me,af as K,aq as pe,A as P}from"./index-Z8DUt18u.js";import{_ as ce,a as _e,b as fe,u as ve}from"./auth-CEy-eMOu.js";import{u as he}from"./download-4Fcgw4rI.js";import{u as ye,a as we}from"./table-xLscuIQ4.js";import{u as Q,a as be,b as X,_ as ge}from"./form-34oM_FHm.js";import{_ as Y}from"./Space-CCrTpFrl.js";import{_ as ke}from"./Grid-tUpxGiRj.js";import"./DataTable-s6EYq0ve.js";import"./user-BD5iFoP8.js";import"./dept-CPxOIfHF.js";import"./TreeSelect-N4Gm5Bfd.js";import"./Tree-C1TOTihx.js";import"./use-table-DjHicHPt.js";function xe(u){return M({url:"/demo/demo/list",method:"get",params:u})}function Ie(u){return M({url:"/demo/demo",method:"post",data:u})}function De(u){return M({url:"/demo/demo",method:"put",data:u})}function q(u){return M({url:`/demo/demo/${u.join(",")}`,method:"delete"})}const Ne=j({name:"DemoOperateDrawer",__name:"demo-operate-drawer",props:W({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:W(["submitted"],["update:visible"]),setup(u,{emit:R}){const m=u,c=R,y=z(u,"visible"),{formRef:D,validate:s,restoreValidation:S}=Q(),{createRequiredRule:v}=be(),$=ae(()=>({add:"新增测试单表",edit:"编辑测试单表"})[m.operateType]),o=le(w());function w(){return{deptId:null,userId:null,orderNum:null,testKey:"",value:"",remark:""}}const b={id:v("主键不能为空"),deptId:v("部门不能为空"),userId:v("用户不能为空"),testKey:v("key 键不能为空"),value:v("值不能为空")};function N(){if(m.operateType==="add"){Object.assign(o,w());return}m.operateType==="edit"&&m.rowData&&Object.assign(o,m.rowData)}function U(){y.value=!1}async function T(){var g;if(await s(),m.operateType==="add"){const{deptId:a,userId:i,orderNum:r,testKey:k,value:x}=o,{error:_}=await Ie({deptId:a,userId:i,orderNum:r,testKey:k,value:x});if(_)return}if(m.operateType==="edit"){const{id:a,deptId:i,userId:r,orderNum:k,testKey:x,value:_}=o,{error:C}=await De({id:a,deptId:i,userId:r,orderNum:k,testKey:x,value:_});if(C)return}(g=window.$message)==null||g.success(h("common.updateSuccess")),U(),c("submitted")}return se(y,()=>{y.value&&(N(),S())}),(g,a)=>{const i=E,r=ge,k=V,x=de,_=H,C=X,p=L,f=Y,d=re,B=ue;return O(),G(B,{show:y.value,"onUpdate:show":a[6]||(a[6]=l=>y.value=l),title:$.value,"display-directive":"show",width:800,class:"max-w-90%"},{default:t(()=>[e(d,{title:$.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[e(f,{size:16},{default:t(()=>[e(p,{onClick:U},{default:t(()=>[A(F(n(h)("common.cancel")),1)]),_:1}),e(p,{type:"primary",onClick:T},{default:t(()=>[A(F(n(h)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(C,{ref_key:"formRef",ref:D,model:o,rules:b},{default:t(()=>[e(r,{label:"部门",path:"deptId"},{default:t(()=>[e(i,{value:o.deptId,"onUpdate:value":a[0]||(a[0]=l=>o.deptId=l),placeholder:"请选择部门"},null,8,["value"])]),_:1}),e(r,{label:"用户",path:"userId"},{default:t(()=>[e(k,{value:o.userId,"onUpdate:value":a[1]||(a[1]=l=>o.userId=l),placeholder:"请选择用户"},null,8,["value"])]),_:1}),e(r,{label:"排序号",path:"orderNum"},{default:t(()=>[e(x,{value:o.orderNum,"onUpdate:value":a[2]||(a[2]=l=>o.orderNum=l),placeholder:"请输入排序号"},null,8,["value"])]),_:1}),e(r,{label:"key 键",path:"testKey"},{default:t(()=>[e(_,{value:o.testKey,"onUpdate:value":a[3]||(a[3]=l=>o.testKey=l),placeholder:"请输入 key 键"},null,8,["value"])]),_:1}),e(r,{label:"值",path:"value"},{default:t(()=>[e(_,{value:o.value,"onUpdate:value":a[4]||(a[4]=l=>o.value=l),placeholder:"请输入值"},null,8,["value"])]),_:1}),e(r,{label:"备注",path:"remark"},{default:t(()=>[e(_,{value:o.remark,"onUpdate:value":a[5]||(a[5]=l=>o.remark=l),type:"textarea",placeholder:"请输入备注"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show","title"])}}}),Ue=j({name:"DemoSearch",__name:"demo-search",props:{model:{required:!0},modelModifiers:{}},emits:W(["reset","search"],["update:model"]),setup(u,{emit:R}){const m=R,{formRef:c,validate:y,restoreValidation:D}=Q(),s=z(u,"model");async function S(){Object.assign(s.value.params,{}),await D(),m("reset")}async function v(){await y(),m("search")}return($,o)=>{const w=E,b=fe,N=V,U=H,T=te,g=L,a=oe,i=Y,r=ke,k=X,x=_e,_=ce,C=J;return O(),G(C,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(_,null,{default:t(()=>[e(x,{title:n(h)("common.search"),name:"user-search"},{default:t(()=>[e(k,{ref_key:"formRef",ref:c,model:s.value,"label-placement":"left","label-width":80},{default:t(()=>[e(r,{responsive:"screen","item-responsive":""},{default:t(()=>[e(b,{span:"24 s:12 m:6",label:"部门",path:"deptId",class:"pr-24px"},{default:t(()=>[e(w,{value:s.value.deptId,"onUpdate:value":o[0]||(o[0]=p=>s.value.deptId=p),placeholder:"请选择部门"},null,8,["value"])]),_:1}),e(b,{span:"24 s:12 m:6",label:"用户",path:"userId",class:"pr-24px"},{default:t(()=>[e(N,{value:s.value.userId,"onUpdate:value":o[1]||(o[1]=p=>s.value.userId=p),placeholder:"请选择用户"},null,8,["value"])]),_:1}),e(b,{span:"24 s:12 m:6",label:"key 键",path:"testKey",class:"pr-24px"},{default:t(()=>[e(U,{value:s.value.testKey,"onUpdate:value":o[2]||(o[2]=p=>s.value.testKey=p),placeholder:"请输入 key 键"},null,8,["value"])]),_:1}),e(b,{span:"24 s:12 m:6",label:"值",path:"value",class:"pr-24px"},{default:t(()=>[e(U,{value:s.value.value,"onUpdate:value":o[3]||(o[3]=p=>s.value.value=p),placeholder:"请输入值"},null,8,["value"])]),_:1}),e(b,{"show-feedback":!1,span:"24",class:"pr-24px"},{default:t(()=>[e(i,{class:"w-full",justify:"end"},{default:t(()=>[e(g,{onClick:S},{icon:t(()=>[e(T,{class:"text-icon"})]),default:t(()=>[A(" "+F(n(h)("common.reset")),1)]),_:1}),e(g,{type:"primary",ghost:"",onClick:v},{icon:t(()=>[e(a,{class:"text-icon"})]),default:t(()=>[A(" "+F(n(h)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1})]),_:1})}}}),Ce={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Ve=j({name:"demo_demo",__name:"index",setup(u){const R=ie(),{download:m}=he(),{hasAuth:c}=ve(),{columns:y,columnChecks:D,data:s,getData:S,getDataByPage:v,loading:$,mobilePagination:o,searchParams:w,resetSearchParams:b}=ye({apiFn:xe,apiParams:{pageNum:1,pageSize:10,deptId:null,userId:null,orderNum:null,testKey:null,value:null,params:{}},columns:()=>[{type:"selection",align:"center",width:48},{key:"id",title:"主键",align:"center",minWidth:120},{key:"deptId",title:"部门 ID",align:"center",minWidth:120},{key:"userId",title:"用户 ID",align:"center",minWidth:120},{key:"orderNum",title:"排序号",align:"center",minWidth:120},{key:"testKey",title:"key 键",align:"center",minWidth:120},{key:"value",title:"值",align:"center",minWidth:120},{key:"operate",title:h("common.operate"),align:"center",width:130,render:f=>{const d=()=>!c("demo:demo:edit")||!c("demo:demo:remove")?null:e(pe,{vertical:!0},null),B=()=>c("demo:demo:edit")?e(P,{text:!0,type:"primary",icon:"material-symbols:drive-file-rename-outline-outline",tooltipContent:h("common.edit"),onClick:()=>C(f.id)},null):null,l=()=>c("demo:demo:remove")?e(P,{text:!0,type:"error",icon:"material-symbols:delete-outline",tooltipContent:h("common.delete"),popconfirmContent:h("common.confirmDelete"),onPositiveClick:()=>_(f.id)},null):null;return e("div",{class:"flex-center gap-8px"},[B(),d(),l()])}}]}),{drawerVisible:N,operateType:U,editingData:T,handleAdd:g,handleEdit:a,checkedRowKeys:i,onBatchDeleted:r,onDeleted:k}=we(s,S);async function x(){const{error:f}=await q(i.value);f||r()}async function _(f){const{error:d}=await q([f]);d||k()}async function C(f){a("id",f)}async function p(){m("/demo/demo/export",w,`测试单表_${new Date().getTime()}.xlsx`)}return(f,d)=>{const B=ne,l=ee,Z=J;return O(),me("div",Ce,[e(Ue,{model:n(w),"onUpdate:model":d[0]||(d[0]=I=>K(w)?w.value=I:null),onReset:n(b),onSearch:n(v)},null,8,["model","onReset","onSearch"]),e(Z,{title:"测试单表列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(B,{columns:n(D),"onUpdate:columns":d[1]||(d[1]=I=>K(D)?D.value=I:null),"disabled-delete":n(i).length===0,loading:n($),"show-add":n(c)("demo:demo:add"),"show-delete":n(c)("demo:demo:remove"),"show-export":n(c)("demo:demo:export"),onAdd:n(g),onDelete:x,onExport:p,onRefresh:n(S)},null,8,["columns","disabled-delete","loading","show-add","show-delete","show-export","onAdd","onRefresh"])]),default:t(()=>[e(l,{"checked-row-keys":n(i),"onUpdate:checkedRowKeys":d[2]||(d[2]=I=>K(i)?i.value=I:null),columns:n(y),data:n(s),"flex-height":!n(R).isMobile,"scroll-x":962,loading:n($),remote:"","row-key":I=>I.id,pagination:n(o),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Ne,{visible:n(N),"onUpdate:visible":d[3]||(d[3]=I=>K(N)?N.value=I:null),"operate-type":n(U),"row-data":n(T),onSubmitted:n(v)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ve as default};
