import{_ as ne,a as le,b as ae}from"./round-refresh-B0IUvXWI.js";import{aj as M,d as E,ak as j,al as H,a as se,$ as e,q as oe,am as ie,c as z,o as F,w as l,f as n,an as re,s as ce,h as t,v as J,ao as de,e as I,t as k,B as Q,g as A,ap as me,R as X,I as ue,b as pe,af as W,aq as _e,A as O}from"./index-Z8DUt18u.js";import{_ as ye,a as fe,b as ve,u as ge}from"./auth-CEy-eMOu.js";import{u as he}from"./download-4Fcgw4rI.js";import{u as be,a as Te}from"./table-xLscuIQ4.js";import{u as V}from"./dict-D3hWHJVt.js";import{_ as P}from"./dict-tag.vue_vue_type_script_setup_true_lang-C3NRfqiy.js";import{_ as we}from"./dict-radio.vue_vue_type_script_setup_true_lang-Chn5U5qK.js";import{_ as xe}from"./form-tip.vue_vue_type_script_setup_true_lang-8erTB2XS.js";import{_ as Y}from"./dict-select.vue_vue_type_script_setup_true_lang-B4-DraB3.js";import{u as Z,a as Se,b as ee,_ as ke}from"./form-34oM_FHm.js";import{_ as te}from"./Space-CCrTpFrl.js";import{_ as Ne}from"./Grid-tUpxGiRj.js";import{_ as Ce}from"./DataTable-s6EYq0ve.js";import"./use-table-DjHicHPt.js";import"./dict-CTAJ1fRb.js";function De(m){return M({url:"/system/client/list",method:"get",params:m})}function qe(m){return M({url:"/system/client",method:"post",data:m})}function $e(m){return M({url:"/system/client",method:"put",data:m})}function G(m){return M({url:`/system/client/${m.join(",")}`,method:"delete"})}const Ke={class:"flex-center"},Ue={class:"pl-3px"},Ie={class:"text-sm"},Re={class:"flex-center"},Be={class:"pl-3px"},Le={class:"text-sm"},We=E({name:"ClientOperateDrawer",__name:"client-operate-drawer",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(m,{emit:R}){const p=m,f=R,w=H(m,"visible"),{formRef:N,validate:_,restoreValidation:q}=Z(),{createRequiredRule:y}=Se(),$=se(()=>({add:e("page.system.client.addClient"),edit:e("page.system.client.editClient")})[p.operateType]),a=oe(g());function g(){return{clientKey:"",clientSecret:"",grantTypeList:[],deviceType:void 0,activeTimeout:1800,timeout:604800,status:"0"}}const S={id:y(e("page.system.client.form.clientId.required")),clientKey:y(e("page.system.client.form.clientKey.required")),clientSecret:y(e("page.system.client.form.clientSecret.required")),grantTypeList:y(e("page.system.client.form.grantTypeList.required")),deviceType:y(e("page.system.client.form.deviceType.required")),activeTimeout:y(e("page.system.client.form.activeTimeout.required")),timeout:y(e("page.system.client.form.timeout.required"))};function C(){if(p.operateType==="add"){Object.assign(a,g());return}p.operateType==="edit"&&p.rowData&&Object.assign(a,p.rowData)}function K(){w.value=!1}async function U(){var v;if(await _(),p.operateType==="add"){const{clientKey:o,clientSecret:d,grantTypeList:r,deviceType:h,activeTimeout:b,timeout:T,status:u}=a,{error:D}=await qe({clientKey:o,clientSecret:d,grantTypeList:r,deviceType:h,activeTimeout:b,timeout:T,status:u});if(D)return}if(p.operateType==="edit"){const{id:o,clientId:d,clientKey:r,clientSecret:h,grantTypeList:b,deviceType:T,activeTimeout:u,timeout:D,status:s}=a,{error:c}=await $e({id:o,clientId:d,clientKey:r,clientSecret:h,grantTypeList:b,deviceType:T,activeTimeout:u,timeout:D,status:s});if(c)return}(v=window.$message)==null||v.success(e("common.saveSuccess")),K(),f("submitted")}return ie(w,()=>{w.value&&(C(),q())}),(v,o)=>{const d=J,r=ke,h=Y,b=xe,T=de,u=we,D=ee,s=Q,c=te,B=re,L=me;return F(),z(L,{show:w.value,"onUpdate:show":o[8]||(o[8]=i=>w.value=i),title:$.value,"display-directive":"show",width:800,class:"max-w-90%"},{default:l(()=>[n(B,{title:$.value,"native-scrollbar":!1,closable:""},{footer:l(()=>[n(c,{size:16},{default:l(()=>[n(s,{onClick:K},{default:l(()=>[A(k(t(e)("common.cancel")),1)]),_:1}),n(s,{type:"primary",onClick:U},{default:l(()=>[A(k(t(e)("common.save")),1)]),_:1})]),_:1})]),default:l(()=>[n(D,{ref_key:"formRef",ref:N,model:a,rules:S},{default:l(()=>[v.operateType==="edit"?(F(),z(r,{key:0,label:t(e)("page.system.client.clientId"),path:"clientId"},{default:l(()=>[n(d,{value:a.clientId,"onUpdate:value":o[0]||(o[0]=i=>a.clientId=i),disabled:"",placeholder:t(e)("page.system.client.form.clientId.required")},null,8,["value","placeholder"])]),_:1},8,["label"])):ce("",!0),n(r,{label:t(e)("page.system.client.clientKey"),path:"clientKey"},{default:l(()=>[n(d,{value:a.clientKey,"onUpdate:value":o[1]||(o[1]=i=>a.clientKey=i),disabled:v.operateType==="edit",placeholder:t(e)("page.system.client.form.clientKey.required")},null,8,["value","disabled","placeholder"])]),_:1},8,["label"]),n(r,{label:t(e)("page.system.client.clientSecret"),path:"clientSecret"},{default:l(()=>[n(d,{value:a.clientSecret,"onUpdate:value":o[2]||(o[2]=i=>a.clientSecret=i),disabled:v.operateType==="edit",placeholder:t(e)("page.system.client.form.clientSecret.required")},null,8,["value","disabled","placeholder"])]),_:1},8,["label"]),n(r,{label:t(e)("page.system.client.grantTypeList"),path:"grantTypeList"},{default:l(()=>[n(h,{value:a.grantTypeList,"onUpdate:value":o[3]||(o[3]=i=>a.grantTypeList=i),placeholder:t(e)("page.system.client.form.grantTypeList.required"),"dict-code":"sys_grant_type",multiple:""},null,8,["value","placeholder"])]),_:1},8,["label"]),n(r,{label:t(e)("page.system.client.deviceType"),path:"deviceType"},{default:l(()=>[n(h,{value:a.deviceType,"onUpdate:value":o[4]||(o[4]=i=>a.deviceType=i),placeholder:t(e)("page.system.client.form.deviceType.required"),"dict-code":"sys_device_type"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(r,{label:t(e)("page.system.client.activeTimeout"),path:"activeTimeout"},{label:l(()=>[I("div",Ke,[n(b,{content:t(e)("page.system.client.form.activeTimeout.tooltip")},null,8,["content"]),I("span",Ue,k(t(e)("page.system.client.activeTimeout")),1)])]),default:l(()=>[n(T,{value:a.activeTimeout,"onUpdate:value":o[5]||(o[5]=i=>a.activeTimeout=i),placeholder:t(e)("page.system.client.form.activeTimeout.required")},{suffix:l(()=>[I("span",Ie,k(t(e)("common.second")),1)]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(r,{label:t(e)("page.system.client.timeout"),path:"timeout"},{label:l(()=>[I("div",Re,[n(b,{content:t(e)("page.system.client.form.timeout.tooltip")},null,8,["content"]),I("span",Be,k(t(e)("page.system.client.timeout")),1)])]),default:l(()=>[n(T,{value:a.timeout,"onUpdate:value":o[6]||(o[6]=i=>a.timeout=i),placeholder:t(e)("page.system.client.form.timeout.required")},{suffix:l(()=>[I("span",Le,k(t(e)("common.second")),1)]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(r,{label:t(e)("page.system.client.status"),path:"status"},{default:l(()=>[n(u,{value:a.status,"onUpdate:value":o[7]||(o[7]=i=>a.status=i),placeholder:t(e)("page.system.client.form.status.required"),disabled:a.id==1,"dict-code":"sys_normal_disable"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show","title"])}}}),Fe=E({name:"ClientSearch",__name:"client-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(m,{emit:R}){const p=R,{formRef:f,validate:w,restoreValidation:N}=Z(),_=H(m,"model");async function q(){await N(),p("reset")}async function y(){await w(),p("search")}return($,a)=>{const g=J,S=ve,C=Y,K=ne,U=Q,v=le,o=te,d=Ne,r=ee,h=fe,b=ye,T=X;return F(),z(T,{bordered:!1,size:"small",class:"card-wrapper"},{default:l(()=>[n(b,null,{default:l(()=>[n(h,{title:t(e)("common.search"),name:"user-search"},{default:l(()=>[n(r,{ref_key:"formRef",ref:f,model:_.value,"label-placement":"left","label-width":90},{default:l(()=>[n(d,{responsive:"screen","item-responsive":""},{default:l(()=>[n(S,{span:"24 s:12 m:6",label:t(e)("page.system.client.clientKey"),path:"clientKey",class:"pr-24px"},{default:l(()=>[n(g,{value:_.value.clientKey,"onUpdate:value":a[0]||(a[0]=u=>_.value.clientKey=u),placeholder:t(e)("page.system.client.form.clientKey.required")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(S,{span:"24 s:12 m:6",label:t(e)("page.system.client.clientSecret"),path:"clientSecret",class:"pr-24px"},{default:l(()=>[n(g,{value:_.value.clientSecret,"onUpdate:value":a[1]||(a[1]=u=>_.value.clientSecret=u),placeholder:t(e)("page.system.client.form.clientSecret.required")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(S,{span:"24 s:12 m:6",label:t(e)("page.system.client.status"),path:"status",class:"pr-24px"},{default:l(()=>[n(C,{value:_.value.status,"onUpdate:value":a[2]||(a[2]=u=>_.value.status=u),placeholder:t(e)("page.system.client.form.status.required"),"dict-code":"sys_normal_disable",clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),n(S,{span:"24",class:"pr-24px"},{default:l(()=>[n(o,{class:"w-full",justify:"end"},{default:l(()=>[n(U,{onClick:q},{icon:l(()=>[n(K,{class:"text-icon"})]),default:l(()=>[A(" "+k(t(e)("common.reset")),1)]),_:1}),n(U,{type:"primary",ghost:"",onClick:y},{icon:l(()=>[n(v,{class:"text-icon"})]),default:l(()=>[A(" "+k(t(e)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1})]),_:1})}}}),Ae={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},nt=E({name:"system_client",__name:"index",setup(m){V("sys_grant_type"),V("sys_device_type"),V("sys_normal_disable");const R=ue(),{download:p}=he(),{hasAuth:f}=ge(),{columns:w,columnChecks:N,data:_,getData:q,getDataByPage:y,loading:$,mobilePagination:a,searchParams:g,resetSearchParams:S}=be({apiFn:De,apiParams:{pageNum:1,pageSize:10,clientKey:null,clientSecret:null,status:null},columns:()=>[{type:"selection",align:"center",disabled:s=>s.id===1,width:48},{key:"index",title:e("common.index"),align:"center",width:64},{key:"clientId",title:e("page.system.client.clientId"),align:"center",minWidth:120},{key:"clientKey",title:e("page.system.client.clientKey"),align:"center",minWidth:120},{key:"clientSecret",title:e("page.system.client.clientSecret"),align:"center",minWidth:120},{key:"grantTypeList",title:e("page.system.client.grantTypeList"),align:"center",minWidth:120,render:s=>n(P,{value:s.grantTypeList,"dict-code":"sys_grant_type"},null)},{key:"deviceType",title:e("page.system.client.deviceType"),align:"center",minWidth:120,render:s=>n(P,{value:s.deviceType,"dict-code":"sys_device_type"},null)},{key:"activeTimeout",title:e("page.system.client.activeTimeout"),align:"center",minWidth:120,render:s=>`${s.activeTimeout}${e("common.second")}`},{key:"timeout",title:e("page.system.client.timeout"),align:"center",minWidth:120,render:s=>`${s.timeout}${e("common.second")}`},{key:"status",title:e("page.system.client.status"),align:"center",minWidth:120,render:s=>n(P,{value:s.status,"dict-code":"sys_normal_disable"},null)},{key:"operate",title:e("common.operate"),align:"center",width:130,render:s=>{const c=()=>!f("system:client:edit")||!f("system:client:remove")?null:n(_e,{vertical:!0},null),B=()=>f("system:client:edit")?n(O,{text:!0,type:"primary",icon:"material-symbols:drive-file-rename-outline-outline",tooltipContent:e("common.edit"),onClick:()=>u(s.id)},null):null,L=()=>f("system:client:remove")?n(O,{text:!0,type:"error",icon:"material-symbols:delete-outline",tooltipContent:e("common.delete"),popconfirmContent:e("common.confirmDelete"),onPositiveClick:()=>T(s.id),disabled:s.id===1},null):null;return n("div",{class:"flex-center gap-8px"},[B(),c(),L()])}}]}),{drawerVisible:C,operateType:K,editingData:U,handleAdd:v,handleEdit:o,checkedRowKeys:d,onBatchDeleted:r,onDeleted:h}=Te(_,q);async function b(){const{error:s}=await G(d.value);s||r()}async function T(s){const{error:c}=await G([s]);c||h()}async function u(s){o("id",s)}async function D(){p("/system/client/export",g,`客户端_${new Date().getTime()}.xlsx`)}return(s,c)=>{const B=ae,L=Ce,i=X;return F(),pe("div",Ae,[n(Fe,{model:t(g),"onUpdate:model":c[0]||(c[0]=x=>W(g)?g.value=x:null),onReset:t(S),onSearch:t(y)},null,8,["model","onReset","onSearch"]),n(i,{title:t(e)("page.system.client.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":l(()=>[n(B,{columns:t(N),"onUpdate:columns":c[1]||(c[1]=x=>W(N)?N.value=x:null),"disabled-delete":t(d).length===0,loading:t($),"show-add":t(f)("system:client:add"),"show-delete":t(f)("system:client:remove"),"show-export":t(f)("system:client:export"),onAdd:t(v),onDelete:b,onExport:D,onRefresh:t(q)},null,8,["columns","disabled-delete","loading","show-add","show-delete","show-export","onAdd","onRefresh"])]),default:l(()=>[n(L,{"checked-row-keys":t(d),"onUpdate:checkedRowKeys":c[2]||(c[2]=x=>W(d)?d.value=x:null),columns:t(w),data:t(_),size:"small","flex-height":!t(R).isMobile,"scroll-x":962,loading:t($),remote:"","row-key":x=>x.id,pagination:t(a),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),n(We,{visible:t(C),"onUpdate:visible":c[3]||(c[3]=x=>W(C)?C.value=x:null),"operate-type":t(K),"row-data":t(U),onSubmitted:t(y)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{nt as default};
