import{b4 as $e,cq as We,cr as He,cs as qe,aZ as Je,at as Ze,au as L,ay as D,bO as Ge,d as Qe,a1 as c,ct as Xe,cu as Ye,cv as et,cw as tt,cx as z,T as nt,a8 as at,cy as lt,aJ as ae,b8 as ot,cz as rt,r as m,az as it,a2 as dt,ce as st,aE as V,bb as j,a as u,cA as ct,cB as ut,aB as ie,aF as ht,bT as ft,y as vt,bi as b,cC as gt,cD as mt,cE as le,aD as yt}from"./index-Z8DUt18u.js";import{_ as pt,c as bt,u as St,t as wt,a as xt}from"./Tree-C1TOTihx.js";function Ct(t){const{popoverColor:h,boxShadow2:r,borderRadius:s,heightMedium:i,dividerColor:y,textColor2:K}=t;return{menuPadding:"4px",menuColor:h,menuBoxShadow:r,menuBorderRadius:s,menuHeight:`calc(${i} * 7.6)`,actionDividerColor:y,actionTextColor:K,actionPadding:"8px 12px",headerDividerColor:y,headerTextColor:K,headerPadding:"8px 12px"}}const kt=$e({name:"TreeSelect",common:Je,peers:{Tree:qe,Empty:He,InternalSelection:We},self:Ct}),Tt=Ze([L("tree-select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),L("tree-select-menu",`
 position: relative;
 overflow: hidden;
 margin: 4px 0;
 transition: box-shadow .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-menu-border-radius);
 box-shadow: var(--n-menu-box-shadow);
 background-color: var(--n-menu-color);
 outline: none;
 `,[L("tree","max-height: var(--n-menu-height);"),D("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),D("header",`
 padding: var(--n-header-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-header-divider-color);
 color: var(--n-header-text-color);
 `),D("action",`
 padding: var(--n-action-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),Ge()])]);function oe(t,h){const{rawNode:r}=t;return Object.assign(Object.assign({},r),{label:r[h],value:t.key})}function re(t,h,r,s){const{rawNode:i}=t;return Object.assign(Object.assign({},i),{value:t.key,label:h.map(y=>y.rawNode[s]).join(r)})}const Kt=Object.assign(Object.assign(Object.assign(Object.assign({},ie.props),{bordered:{type:Boolean,default:!0},cascade:Boolean,checkable:Boolean,clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},consistentMenuWidth:{type:Boolean,default:!0},defaultShow:Boolean,defaultValue:{type:[String,Number,Array],default:null},disabled:{type:Boolean,default:void 0},filterable:Boolean,checkStrategy:{type:String,default:"all"},loading:Boolean,maxTagCount:[String,Number],multiple:Boolean,showPath:Boolean,separator:{type:String,default:" / "},options:{type:Array,default:()=>[]},placeholder:String,placement:{type:String,default:"bottom-start"},show:{type:Boolean,default:void 0},size:String,value:[String,Number,Array],to:z.propTo,menuProps:Object,virtualScroll:{type:Boolean,default:!0},status:String,renderTag:Function,ellipsisTagPopoverProps:Object}),wt),{renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,watchProps:Array,getChildren:Function,onBlur:Function,onFocus:Function,onLoad:Function,onUpdateShow:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],"onUpdate:show":[Function,Array],leafOnly:Boolean}),Pt=Qe({name:"TreeSelect",props:Kt,slots:Object,setup(t){const h=m(null),r=m(null),s=m(null),i=m(null),{mergedClsPrefixRef:y,namespaceRef:K,inlineThemeDisabled:v}=it(t),{localeRef:A}=dt("Select"),{mergedSizeRef:S,mergedDisabledRef:E,mergedStatusRef:de,nTriggerFormBlur:se,nTriggerFormChange:ce,nTriggerFormFocus:ue,nTriggerFormInput:he}=st(t),$=m(t.defaultValue),fe=V(t,"value"),w=j(fe,$),W=m(t.defaultShow),ve=V(t,"show"),x=j(ve,W),F=m(""),ge=u(()=>{const{filter:e}=t;if(e)return e;const{labelField:n}=t;return(l,a)=>l.length?a[n].toLowerCase().includes(l.toLowerCase()):!0}),C=u(()=>ct(t.options,bt(t.keyField,t.childrenField,t.disabledField,void 0))),{value:_}=w,H=m(t.checkable?null:Array.isArray(_)&&_.length?_[_.length-1]:null),B=u(()=>t.multiple&&t.cascade&&t.checkable),q=m(t.defaultExpandAll?void 0:t.defaultExpandedKeys||t.expandedKeys),me=V(t,"expandedKeys"),ye=j(me,q),P=m(!1),pe=u(()=>{const{placeholder:e}=t;return e!==void 0?e:A.value.placeholder}),J=u(()=>{const{value:e}=w;return t.multiple?Array.isArray(e)?e:[]:e===null||Array.isArray(e)?[]:[e]}),be=u(()=>t.checkable?[]:J.value),Se=u(()=>{const{multiple:e,showPath:n,separator:l,labelField:a}=t;if(e)return null;const{value:o}=w;if(!Array.isArray(o)&&o!==null){const{value:d}=C,g=d.getNode(o);if(g!==null)return n?re(g,d.getPath(o).treeNodePath,l,a):oe(g,a)}return null}),we=u(()=>{const{multiple:e,showPath:n,separator:l}=t;if(!e)return null;const{value:a}=w;if(Array.isArray(a)){const o=[],{value:d}=C,{checkedKeys:g}=d.getCheckedKeys(a,{checkStrategy:t.checkStrategy,cascade:B.value,allowNotLoaded:t.allowCheckingNotLoaded}),{labelField:f}=t;return g.forEach(M=>{const O=d.getNode(M);O!==null&&o.push(n?re(O,d.getPath(M).treeNodePath,l,f):oe(O,f))}),o}return[]});function I(){var e;(e=r.value)===null||e===void 0||e.focus()}function Z(){var e;(e=r.value)===null||e===void 0||e.focusInput()}function G(e){const{onUpdateShow:n,"onUpdate:show":l}=t;n&&b(n,e),l&&b(l,e),W.value=e}function k(e,n,l){const{onUpdateValue:a,"onUpdate:value":o}=t;a&&b(a,e,n,l),o&&b(o,e,n,l),$.value=e,he(),ce()}function xe(e,n){const{onUpdateIndeterminateKeys:l,"onUpdate:indeterminateKeys":a}=t;l&&b(l,e,n),a&&b(a,e,n)}function Ce(e,n,l){const{onUpdateExpandedKeys:a,"onUpdate:expandedKeys":o}=t;a&&b(a,e,n,l),o&&b(o,e,n,l),q.value=e}function Q(e){const{onFocus:n}=t;n&&n(e),ue()}function X(e){p();const{onBlur:n}=t;n&&n(e),se()}function p(){G(!1)}function N(){E.value||(F.value="",G(!0),t.filterable&&Z())}function ke(){F.value=""}function Te(e){var n;x.value&&(!((n=r.value)===null||n===void 0)&&n.$el.contains(gt(e))||p())}function Ke(){E.value||(x.value?t.filterable||p():N())}function T(e){const{value:{getNode:n}}=C;return e.map(l=>{var a;return((a=n(l))===null||a===void 0?void 0:a.rawNode)||null})}function Re(e,n,l){const a=T(e),o=l.action==="check"?"select":"unselect",d=l.node;t.multiple?(k(e,a,{node:d,action:o}),t.filterable&&(Z(),t.clearFilterAfterSelect&&(F.value=""))):(e.length?k(e[0],a[0]||null,{node:d,action:o}):k(null,null,{node:d,action:o}),p(),I())}function Fe(e){t.checkable&&xe(e,T(e))}function Pe(e){var n;!((n=i.value)===null||n===void 0)&&n.contains(e.relatedTarget)||(P.value=!0,Q(e))}function Oe(e){var n;!((n=i.value)===null||n===void 0)&&n.contains(e.relatedTarget)||(P.value=!1,X(e))}function _e(e){var n,l,a;!((n=i.value)===null||n===void 0)&&n.contains(e.relatedTarget)||!((a=(l=r.value)===null||l===void 0?void 0:l.$el)===null||a===void 0)&&a.contains(e.relatedTarget)||(P.value=!0,Q(e))}function Be(e){var n,l,a;!((n=i.value)===null||n===void 0)&&n.contains(e.relatedTarget)||!((a=(l=r.value)===null||l===void 0?void 0:l.$el)===null||a===void 0)&&a.contains(e.relatedTarget)||(P.value=!1,X(e))}function Ie(e){e.stopPropagation();const{multiple:n}=t;!n&&t.filterable&&p(),n?k([],[],{node:null,action:"clear"}):k(null,null,{node:null,action:"clear"})}function Me(e){const{value:n}=w;if(Array.isArray(n)){const{value:l}=C,{checkedKeys:a}=l.getCheckedKeys(n,{cascade:B.value,allowNotLoaded:t.allowCheckingNotLoaded}),o=a.findIndex(d=>d===e.value);if(~o){const d=a[o],g=T([d])[0];if(t.checkable){const{checkedKeys:f}=l.uncheck(e.value,a,{checkStrategy:t.checkStrategy,cascade:B.value,allowNotLoaded:t.allowCheckingNotLoaded});k(f,T(f),{node:g,action:"delete"})}else{const f=Array.from(a);f.splice(o,1),k(f,T(f),{node:g,action:"delete"})}}}}function Ae(e){const{value:n}=e.target;F.value=n}function Y(e){const{value:n}=s;return n?n.handleKeydown(e):{enterBehavior:null}}function Ee(e){if(e.key==="Enter"){if(x.value){const{enterBehavior:n}=Y(e);if(!t.multiple)switch(n){case"default":case"toggleSelect":p(),I();break}}else N();e.preventDefault()}else e.key==="Escape"?x.value&&(mt(e),p(),I()):x.value?Y(e):e.key==="ArrowDown"&&N()}function Ne(){p(),I()}function Ue(e){!le(e,"action")&&!le(e,"header")&&e.preventDefault()}const Le=u(()=>{const{renderTag:e}=t;if(e)return function({option:l,handleClose:a}){const{value:o}=l;if(o!==void 0){const d=C.value.getNode(o);if(d)return e({option:d.rawNode,handleClose:a})}return o}});yt(xt,{pendingNodeKeyRef:H,dataTreeMate:C});function ee(){var e;x.value&&((e=h.value)===null||e===void 0||e.syncPosition())}ut(i,ee);const De=St(t),te=u(()=>{if(t.checkable){const e=w.value;return t.multiple&&Array.isArray(e)?C.value.getCheckedKeys(e,{cascade:t.cascade,checkStrategy:De.value,allowNotLoaded:t.allowCheckingNotLoaded}):{checkedKeys:Array.isArray(e)||e===null?[]:[e],indeterminateKeys:[]}}return{checkedKeys:[],indeterminateKeys:[]}}),Ve={getCheckedData:()=>{const{checkedKeys:e}=te.value;return{keys:e,options:T(e)}},getIndeterminateData:()=>{const{indeterminateKeys:e}=te.value;return{keys:e,options:T(e)}},focus:()=>{var e;return(e=r.value)===null||e===void 0?void 0:e.focus()},focusInput:()=>{var e;return(e=r.value)===null||e===void 0?void 0:e.focusInput()},blur:()=>{var e;return(e=r.value)===null||e===void 0?void 0:e.blur()},blurInput:()=>{var e;return(e=r.value)===null||e===void 0?void 0:e.blurInput()}},U=ie("TreeSelect","-tree-select",Tt,kt,t,y),ne=u(()=>{const{common:{cubicBezierEaseInOut:e},self:{menuBoxShadow:n,menuBorderRadius:l,menuColor:a,menuHeight:o,actionPadding:d,actionDividerColor:g,actionTextColor:f,headerDividerColor:M,headerPadding:O,headerTextColor:ze}}=U.value;return{"--n-menu-box-shadow":n,"--n-menu-border-radius":l,"--n-menu-color":a,"--n-menu-height":o,"--n-bezier":e,"--n-action-padding":d,"--n-action-text-color":f,"--n-action-divider-color":g,"--n-header-padding":O,"--n-header-text-color":ze,"--n-header-divider-color":M}}),R=v?ht("tree-select",void 0,ne,t):void 0,je=u(()=>{const{self:{menuPadding:e}}=U.value;return e});return Object.assign(Object.assign({},Ve),{menuElRef:i,mergedStatus:de,triggerInstRef:r,followerInstRef:h,treeInstRef:s,mergedClsPrefix:y,mergedValue:w,mergedShow:x,namespace:K,adjustedTo:z(t),isMounted:ft(),focused:P,menuPadding:je,mergedPlaceholder:pe,mergedExpandedKeys:ye,treeSelectedKeys:be,treeCheckedKeys:J,mergedSize:S,mergedDisabled:E,selectedOption:Se,selectedOptions:we,pattern:F,pendingNodeKey:H,mergedCascade:B,mergedFilter:ge,selectionRenderTag:Le,handleTriggerOrMenuResize:ee,doUpdateExpandedKeys:Ce,handleMenuLeave:ke,handleTriggerClick:Ke,handleMenuClickoutside:Te,handleUpdateCheckedKeys:Re,handleUpdateIndeterminateKeys:Fe,handleTriggerFocus:Pe,handleTriggerBlur:Oe,handleMenuFocusin:_e,handleMenuFocusout:Be,handleClear:Ie,handleDeleteOption:Me,handlePatternInput:Ae,handleKeydown:Ee,handleTabOut:Ne,handleMenuMousedown:Ue,mergedTheme:U,cssVars:v?void 0:ne,themeClass:R==null?void 0:R.themeClass,onRender:R==null?void 0:R.onRender})},render(){const{mergedTheme:t,mergedClsPrefix:h,$slots:r}=this;return c("div",{class:`${h}-tree-select`},c(Xe,null,{default:()=>[c(Ye,null,{default:()=>c(et,{ref:"triggerInstRef",onResize:this.handleTriggerOrMenuResize,status:this.mergedStatus,focused:this.focused,clsPrefix:h,theme:t.peers.InternalSelection,themeOverrides:t.peerOverrides.InternalSelection,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,renderTag:this.selectionRenderTag,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,size:this.mergedSize,bordered:this.bordered,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,active:this.mergedShow,loading:this.loading,multiple:this.multiple,maxTagCount:this.maxTagCount,showArrow:!0,filterable:this.filterable,clearable:this.clearable,pattern:this.pattern,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onDeleteOption:this.handleDeleteOption,onKeydown:this.handleKeydown},{arrow:()=>{var s,i;return[(i=(s=this.$slots).arrow)===null||i===void 0?void 0:i.call(s)]}})}),c(tt,{ref:"followerInstRef",show:this.mergedShow,placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===z.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target"},{default:()=>c(nt,{name:"fade-in-scale-up-transition",appear:this.isMounted,onLeave:this.handleMenuLeave},{default:()=>{var s;if(!this.mergedShow)return null;const{mergedClsPrefix:i,checkable:y,multiple:K,menuProps:v,options:A}=this;return(s=this.onRender)===null||s===void 0||s.call(this),at(c("div",Object.assign({},v,{class:[`${i}-tree-select-menu`,v==null?void 0:v.class,this.themeClass],ref:"menuElRef",style:[(v==null?void 0:v.style)||"",this.cssVars],tabindex:0,onMousedown:this.handleMenuMousedown,onKeydown:this.handleKeydown,onFocusin:this.handleMenuFocusin,onFocusout:this.handleMenuFocusout}),ae(r.header,S=>S?c("div",{class:`${i}-tree-select-menu__header`,"data-header":!0},S):null),c(pt,{ref:"treeInstRef",blockLine:!0,allowCheckingNotLoaded:this.allowCheckingNotLoaded,showIrrelevantNodes:!1,animated:!1,pattern:this.pattern,getChildren:this.getChildren,filter:this.mergedFilter,data:A,cancelable:K,labelField:this.labelField,keyField:this.keyField,disabledField:this.disabledField,childrenField:this.childrenField,theme:t.peers.Tree,themeOverrides:t.peerOverrides.Tree,defaultExpandAll:this.defaultExpandAll,defaultExpandedKeys:this.defaultExpandedKeys,expandedKeys:this.mergedExpandedKeys,checkedKeys:this.treeCheckedKeys,selectedKeys:this.treeSelectedKeys,checkable:y,checkStrategy:this.checkStrategy,cascade:this.mergedCascade,leafOnly:this.leafOnly,multiple:this.multiple,renderLabel:this.renderLabel,renderPrefix:this.renderPrefix,renderSuffix:this.renderSuffix,renderSwitcherIcon:this.renderSwitcherIcon,nodeProps:this.nodeProps,watchProps:this.watchProps,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,overrideDefaultNodeClickBehavior:this.overrideDefaultNodeClickBehavior,internalTreeSelect:!0,internalUnifySelectCheck:!0,internalScrollable:!0,internalScrollablePadding:this.menuPadding,internalFocusable:!1,internalCheckboxFocusable:!1,internalRenderEmpty:()=>c("div",{class:`${i}-tree-select-menu__empty`},ot(r.empty,()=>[c(vt,{theme:t.peers.Empty,themeOverrides:t.peerOverrides.Empty})])),onLoad:this.onLoad,onUpdateCheckedKeys:this.handleUpdateCheckedKeys,onUpdateIndeterminateKeys:this.handleUpdateIndeterminateKeys,onUpdateExpandedKeys:this.doUpdateExpandedKeys}),ae(r.action,S=>S?c("div",{class:`${i}-tree-select-menu__action`,"data-action":!0},S):null),c(rt,{onFocus:this.handleTabOut})),[[lt,this.handleMenuClickoutside,void 0,{capture:!0}]])}})})]}))}});export{Pt as _};
