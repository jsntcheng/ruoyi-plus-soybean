import{r as E,a as P,k as he,l as ve,d as O,m as se,b as G,o as h,e as u,n as we,u as H,p as j,q as Z,$ as l,c as $,w as t,s as D,f as e,N as ie,h as o,v as J,x as de,B as Q,y as ce,z as ye,g as B,t as I,A as be,C as X,D as ue,E as le,F as pe,G as me,H as xe,I as Ce,J as ke,K as W,L as Le,M as Ne,O as $e,P as Re,T as Se,Q as Pe,R as Ie,S as ze}from"./index-Z8DUt18u.js";import{f as Ee}from"./social-B_wn4zlb.js";import{u as Y,a as ee,_ as oe,b as ne,R as Te}from"./form-34oM_FHm.js";import{_ as te}from"./Space-CCrTpFrl.js";function Ue(N){const i=E(0),v=P(()=>Math.ceil(i.value)),m=P(()=>i.value>0),{pause:d,resume:f}=he(({delta:s})=>{if(i.value<=0){i.value=0,d();return}const x=s/1e3;i.value-=x,i.value<=0&&(i.value=0,d())},{immediate:!1});function k(s=N){i.value=s,f()}function w(){i.value=0,d()}return ve(()=>{d()}),{count:v,isCounting:m,start:k,stop:w}}const Be={class:"absolute-lt z-1 size-full overflow-hidden"},Fe={class:"absolute -right-300px -top-900px lt-sm:-right-100px lt-sm:-top-1170px"},Me={height:"1337",width:"1337"},qe={id:"linearGradient-2",x1:"0.79",y1:"0.62",x2:"0.21",y2:"0.86"},Ge=["stop-color"],Oe=["stop-color"],Ke={class:"absolute -bottom-400px -left-200px lt-sm:-bottom-760px lt-sm:-left-100px"},De={height:"896",width:"967.8852157128662"},Ve={id:"linearGradient-3",x1:"0.5",y1:"0",x2:"0.5",y2:"1"},Ae=["stop-color"],We=["stop-color"],je=O({name:"WaveBg",__name:"wave-bg",props:{themeColor:{}},setup(N){const i=N,v=P(()=>se(i.themeColor,200)),m=P(()=>se(i.themeColor,500));return(d,f)=>(h(),G("div",Be,[u("div",Fe,[(h(),G("svg",Me,[u("defs",null,[f[0]||(f[0]=u("path",{id:"path-1",opacity:"1","fill-rule":"evenodd",d:"M1337,668.5 C1337,1037.455193874239 1037.455193874239,1337 668.5,1337 C523.6725684305388,1337 337,1236 370.50000000000006,1094 C434.03835568300906,824.6732385973953 6.906089672974592e-14,892.6277623047779 0,668.5000000000001 C0,299.5448061257611 299.5448061257609,1.1368683772161603e-13 668.4999999999999,0 C1037.455193874239,0 1337,299.544806125761 1337,668.5Z"},null,-1)),u("linearGradient",qe,[u("stop",{offset:"0","stop-color":v.value,"stop-opacity":"1"},null,8,Ge),u("stop",{offset:"1","stop-color":m.value,"stop-opacity":"1"},null,8,Oe)])]),f[1]||(f[1]=u("g",{opacity:"1"},[u("use",{"xlink:href":"#path-1",fill:"url(#linearGradient-2)","fill-opacity":"1"})],-1))]))]),u("div",Ke,[(h(),G("svg",De,[u("defs",null,[f[2]||(f[2]=u("path",{id:"path-2",opacity:"1","fill-rule":"evenodd",d:"M896,448 C1142.6325445712241,465.5747656464056 695.2579309733121,896 448,896 C200.74206902668806,896 5.684341886080802e-14,695.2579309733121 0,448.0000000000001 C0,200.74206902668806 200.74206902668791,5.684341886080802e-14 447.99999999999994,0 C695.2579309733121,0 475,418 896,448Z"},null,-1)),u("linearGradient",Ve,[u("stop",{offset:"0","stop-color":m.value,"stop-opacity":"1"},null,8,Ae),u("stop",{offset:"1","stop-color":v.value,"stop-opacity":"1"},null,8,We)])]),f[3]||(f[3]=u("g",{opacity:"1"},[u("use",{"xlink:href":"#path-2",fill:"url(#linearGradient-3)","fill-opacity":"1"})],-1))]))])]))}}),He={class:"w-full flex-y-center gap-16px"},Ze=["src"],Je={class:"mx-6px flex-y-center justify-between"},Qe=O({name:"PwdLogin",__name:"pwd-login",setup(N){const i=we(),{toggleLoginModule:v}=H(),{formRef:m,validate:d}=Y(),{loading:f,startLoading:k,endLoading:w}=j(),{loading:s,startLoading:x,endLoading:g}=j(),c=E(),r=E(!1),y=E(!1),n=E(!1),F=E(!1),M=E([]),b=Z({tenantId:"000000",username:"admin",password:"admin123"}),R=P(()=>{const{formRules:_,createRequiredRule:a}=ee();return{username:[..._.userName,{required:!0}],password:[a(l("form.pwd.required"))],code:r.value?[a(l("form.code.required"))]:[],tenantId:F.value?_.tenantId:[]}});async function C(){x();const{data:_,error:a}=await ue();a||(F.value=_.tenantEnabled,M.value=_.voList.map(z=>({label:z.companyName,value:z.tenantId})),g())}C();async function p(){if(await d(),n.value){const{tenantId:_,username:a,password:z}=b;le.set("loginRember",{tenantId:_,username:a,password:z})}else le.remove("loginRember");try{await i.login(b)}catch{T()}}async function T(){k();const{data:_,error:a}=await pe();a||(r.value=_.captchaEnabled,_.captchaEnabled&&(b.uuid=_.uuid,c.value=`data:image/gif;base64,${_.img}`)),w()}T();function q(){const _=le.get("loginRember");_&&(n.value=!0,Object.assign(b,_))}q();async function U(_){const{data:a,error:z}=await Ee(_,b.tenantId);z||(window.location.href=a)}return(_,a)=>{const z=ie,K=oe,V=J,S=ce,ae=Q,ge=de,fe=ye,A=be,re=te,_e=ne;return h(),$(_e,{ref_key:"formRef",ref:m,model:b,rules:R.value,size:"large","show-label":!1,onKeyup:a[11]||(a[11]=X(()=>!o(i).loginLoading&&p(),["enter"]))},{default:t(()=>[F.value?(h(),$(K,{key:0,path:"tenantId"},{default:t(()=>[e(z,{value:b.tenantId,"onUpdate:value":a[0]||(a[0]=L=>b.tenantId=L),placeholder:"请选择租户",options:M.value,loading:o(s)},null,8,["value","options","loading"])]),_:1})):D("",!0),e(K,{path:"username"},{default:t(()=>[e(V,{value:b.username,"onUpdate:value":a[1]||(a[1]=L=>b.username=L),placeholder:o(l)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),e(K,{path:"password"},{default:t(()=>[e(V,{value:b.password,"onUpdate:value":a[2]||(a[2]=L=>b.password=L),type:"password","show-password-on":"click",placeholder:o(l)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),r.value?(h(),$(K,{key:1,path:"code"},{default:t(()=>[u("div",He,[e(V,{value:b.code,"onUpdate:value":a[3]||(a[3]=L=>b.code=L),placeholder:o(l)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),e(ge,{show:o(f),size:28,class:"h-42px"},{default:t(()=>[e(ae,{focusable:!1,class:"login-code h-42px w-116px",onClick:T},{default:t(()=>[c.value?(h(),G("img",{key:0,src:c.value},null,8,Ze)):(h(),$(S,{key:1,"show-icon":!1,description:"暂无验证码"}))]),_:1})]),_:1},8,["show"])])]),_:1})):D("",!0),e(re,{vertical:"",size:16,class:"mb-8px"},{default:t(()=>[u("div",Je,[e(fe,{checked:n.value,"onUpdate:checked":a[4]||(a[4]=L=>n.value=L)},{default:t(()=>[B(I(o(l)("page.login.pwdLogin.rememberMe")),1)]),_:1},8,["checked"]),e(re,{size:1},{default:t(()=>[e(A,{class:"color-#44b549",icon:"ic:outline-wechat",onClick:a[5]||(a[5]=L=>U("wechat_open"))}),e(A,{"local-icon":"topiam",onClick:a[6]||(a[6]=L=>U("topiam"))}),e(A,{"local-icon":"maxkey",onClick:a[7]||(a[7]=L=>U("maxkey"))}),e(A,{class:"color-#c71d23",icon:"simple-icons:gitee",onClick:a[8]||(a[8]=L=>U("gitee"))}),e(A,{class:"color-#010409",icon:"mdi:github",onClick:a[9]||(a[9]=L=>U("github"))})]),_:1})]),e(ae,{type:"primary",size:"large",block:"",loading:o(i).loginLoading,onClick:p},{default:t(()=>[B(I(o(l)("common.login")),1)]),_:1},8,["loading"]),y.value?(h(),$(ae,{key:0,size:"large",block:"",onClick:a[10]||(a[10]=L=>o(v)("register"))},{default:t(()=>[B(I(o(l)("page.login.common.register")),1)]),_:1})):D("",!0)]),_:1})]),_:1},8,["model","rules"])}}}),Xe=me(Qe,[["__scopeId","data-v-c7094a26"]]);function Ye(){const{loading:N,startLoading:i,endLoading:v}=j(),{count:m,start:d,stop:f,isCounting:k}=Ue(10),w=P(()=>{let g=l("page.login.codeLogin.getCode");const c=l("page.login.codeLogin.reGetCode",{time:m.value});return N.value&&(g=""),k.value&&(g=c),g});function s(g){var c,r,y,n;return g.trim()===""?((r=(c=window.$message)==null?void 0:c.error)==null||r.call(c,l("form.phone.required")),!1):Te.test(g)?!0:((n=(y=window.$message)==null?void 0:y.error)==null||n.call(y,l("form.phone.invalid")),!1)}async function x(g){var r,y;!s(g)||N.value||(i(),await new Promise(n=>{setTimeout(n,500)}),(y=(r=window.$message)==null?void 0:r.success)==null||y.call(r,l("page.login.codeLogin.sendCodeSuccess")),d(),v())}return{label:w,start:d,stop:f,isCounting:k,loading:N,getCaptcha:x}}const eo={class:"w-full flex-y-center gap-16px"},oo=O({name:"CodeLogin",__name:"code-login",setup(N){const{toggleLoginModule:i}=H(),{formRef:v,validate:m}=Y(),{label:d,isCounting:f,loading:k,getCaptcha:w}=Ye(),s=Z({phone:"",code:""}),x=P(()=>{const{formRules:c}=ee();return{phone:c.phone,code:c.code}});async function g(){var c;await m(),(c=window.$message)==null||c.success(l("page.login.common.validateSuccess"))}return(c,r)=>{const y=J,n=oe,F=Q,M=te,b=ne;return h(),$(b,{ref_key:"formRef",ref:v,model:s,rules:x.value,size:"large","show-label":!1,onKeyup:X(g,["enter"])},{default:t(()=>[e(n,{path:"phone"},{default:t(()=>[e(y,{value:s.phone,"onUpdate:value":r[0]||(r[0]=R=>s.phone=R),placeholder:o(l)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])]),_:1}),e(n,{path:"code"},{default:t(()=>[u("div",eo,[e(y,{value:s.code,"onUpdate:value":r[1]||(r[1]=R=>s.code=R),placeholder:o(l)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),e(F,{size:"large",disabled:o(f),loading:o(k),onClick:r[2]||(r[2]=R=>o(w)(s.phone))},{default:t(()=>[B(I(o(d)),1)]),_:1},8,["disabled","loading"])])]),_:1}),e(M,{vertical:"",size:18,class:"w-full"},{default:t(()=>[e(F,{type:"primary",size:"large",round:"",block:"",onClick:g},{default:t(()=>[B(I(o(l)("common.confirm")),1)]),_:1}),e(F,{size:"large",round:"",block:"",onClick:r[3]||(r[3]=R=>o(i)("pwd-login"))},{default:t(()=>[B(I(o(l)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),no={class:"w-full flex-y-center gap-16px"},to=["src"],ao=O({name:"Register",__name:"register",setup(N){const{toggleLoginModule:i}=H(),{formRef:v,validate:m}=Y(),{loading:d,startLoading:f,endLoading:k}=j(),{loading:w,startLoading:s,endLoading:x}=j(),g=E(),c=E(!1),r=E(!1),y=E([]),n=Z({tenantId:"000000",username:"",code:"",password:"",confirmPassword:"",userType:"sys_user"}),F=P(()=>{const{formRules:C,createConfirmPwdRule:p,createRequiredRule:T}=ee();return{tenantId:r.value?C.tenantId:[],username:[...C.userName,{required:!0}],password:[...C.pwd,{required:!0}],confirmPassword:p(n.password),code:c.value?[T(l("form.code.required"))]:[]}});async function M(){var C;try{await m(),s();const{error:p}=await xe({tenantId:n.tenantId,username:n.username,password:n.password,code:n.code,uuid:n.uuid,grantType:"password",userType:n.userType,clientId:"e5cd7e4891bf95d1d19206ce24a7b32e"});if(p){R();return}(C=window.$message)==null||C.success("注册成功"),i("pwd-login")}catch{R()}finally{x()}}async function b(){const{data:C,error:p}=await ue();p||(r.value=C.tenantEnabled,y.value=C.voList.map(T=>({label:T.companyName,value:T.tenantId})))}b();async function R(){f();const{data:C,error:p}=await pe();p||(c.value=C.captchaEnabled,C.captchaEnabled&&(n.uuid=C.uuid,g.value=`data:image/gif;base64,${C.img}`)),k()}return R(),(C,p)=>{const T=ie,q=oe,U=J,_=ce,a=Q,z=de,K=te,V=ne;return h(),$(V,{ref_key:"formRef",ref:v,model:n,rules:F.value,size:"large","show-label":!1,onKeyup:p[6]||(p[6]=X(()=>!o(w)&&M(),["enter"]))},{default:t(()=>[r.value?(h(),$(q,{key:0,path:"tenantId"},{default:t(()=>[e(T,{value:n.tenantId,"onUpdate:value":p[0]||(p[0]=S=>n.tenantId=S),options:y.value,enabled:r.value},null,8,["value","options","enabled"])]),_:1})):D("",!0),e(q,{path:"username"},{default:t(()=>[e(U,{value:n.username,"onUpdate:value":p[1]||(p[1]=S=>n.username=S),placeholder:o(l)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),e(q,{path:"password"},{default:t(()=>[e(U,{value:n.password,"onUpdate:value":p[2]||(p[2]=S=>n.password=S),type:"password","show-password-on":"click",placeholder:o(l)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),e(q,{path:"confirmPassword"},{default:t(()=>[e(U,{value:n.confirmPassword,"onUpdate:value":p[3]||(p[3]=S=>n.confirmPassword=S),type:"password","show-password-on":"click",placeholder:o(l)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),c.value?(h(),$(q,{key:1,path:"code"},{default:t(()=>[u("div",no,[e(U,{value:n.code,"onUpdate:value":p[4]||(p[4]=S=>n.code=S),placeholder:o(l)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),e(z,{show:o(d),size:28,class:"h-42px"},{default:t(()=>[e(a,{focusable:!1,class:"login-code h-42px w-116px",onClick:R},{default:t(()=>[g.value?(h(),G("img",{key:0,src:g.value},null,8,to)):(h(),$(_,{key:1,"show-icon":!1,description:"暂无验证码"}))]),_:1})]),_:1},8,["show"])])]),_:1})):D("",!0),e(K,{vertical:"",size:18,class:"w-full"},{default:t(()=>[e(a,{type:"primary",size:"large",block:"",loading:o(w),onClick:M},{default:t(()=>[B(I(o(l)("page.login.common.register")),1)]),_:1},8,["loading"]),e(a,{size:"large",block:"",onClick:p[5]||(p[5]=S=>o(i)("pwd-login"))},{default:t(()=>[B(I(o(l)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),lo=me(ao,[["__scopeId","data-v-d3581baa"]]),so=O({name:"ResetPwd",__name:"reset-pwd",setup(N){const{toggleLoginModule:i}=H(),{formRef:v,validate:m}=Y(),d=Z({phone:"",code:"",password:"",confirmPassword:""}),f=P(()=>{const{formRules:w,createConfirmPwdRule:s}=ee();return{phone:w.phone,password:w.pwd,confirmPassword:s(d.password)}});async function k(){var w;await m(),(w=window.$message)==null||w.success(l("page.login.common.validateSuccess"))}return(w,s)=>{const x=J,g=oe,c=Q,r=te,y=ne;return h(),$(y,{ref_key:"formRef",ref:v,model:d,rules:f.value,size:"large","show-label":!1,onKeyup:X(k,["enter"])},{default:t(()=>[e(g,{path:"phone"},{default:t(()=>[e(x,{value:d.phone,"onUpdate:value":s[0]||(s[0]=n=>d.phone=n),placeholder:o(l)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])]),_:1}),e(g,{path:"code"},{default:t(()=>[e(x,{value:d.code,"onUpdate:value":s[1]||(s[1]=n=>d.code=n),placeholder:o(l)("page.login.common.codePlaceholder")},null,8,["value","placeholder"])]),_:1}),e(g,{path:"password"},{default:t(()=>[e(x,{value:d.password,"onUpdate:value":s[2]||(s[2]=n=>d.password=n),type:"password","show-password-on":"click",placeholder:o(l)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),e(g,{path:"confirmPassword"},{default:t(()=>[e(x,{value:d.confirmPassword,"onUpdate:value":s[3]||(s[3]=n=>d.confirmPassword=n),type:"password","show-password-on":"click",placeholder:o(l)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),e(r,{vertical:"",size:18,class:"w-full"},{default:t(()=>[e(c,{type:"primary",size:"large",round:"",block:"",onClick:k},{default:t(()=>[B(I(o(l)("common.confirm")),1)]),_:1}),e(c,{size:"large",round:"",block:"",onClick:s[4]||(s[4]=n=>o(i)("pwd-login"))},{default:t(()=>[B(I(o(l)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),ro=O({name:"BindWechat",__name:"bind-wechat",setup(N){return(i,v)=>(h(),G("div"))}}),io={class:"w-400px lt-sm:w-300px"},co={class:"flex-y-center justify-between"},uo={class:"text-28px text-primary font-500 lt-sm:text-22px"},po={class:"i-flex-col"},mo={class:"pt-24px"},go={class:"text-18px text-primary font-medium"},fo={class:"pt-24px"},yo=O({name:"login",__name:"index",props:{module:{}},setup(N){const i=N,v=Ce(),m=ke(),d={"pwd-login":{label:W["pwd-login"],component:Xe},"code-login":{label:W["code-login"],component:oo},register:{label:W.register,component:lo},"reset-pwd":{label:W["reset-pwd"],component:so},"bind-wechat":{label:W["bind-wechat"],component:ro}},f=P(()=>d[i.module||"pwd-login"]),k=P(()=>m.darkMode?se(m.themeColor,600):m.themeColor),w=P(()=>{const s="#ffffff",x=m.darkMode?.5:.2;return Le(s,m.themeColor,x)});return(s,x)=>{const g=je,c=Ne,r=$e,y=Re,n=Ie;return h(),G("div",{class:"relative size-full flex-center overflow-hidden",style:ze({backgroundColor:w.value})},[e(g,{"theme-color":k.value},null,8,["theme-color"]),e(n,{bordered:!1,class:"relative z-4 w-auto rd-12px"},{default:t(()=>[u("div",io,[u("header",co,[e(c,{class:"w-64px text-primary lt-sm:text-48px"}),u("h3",uo,I(o(l)("system.title")),1),u("div",po,[e(r,{"theme-schema":o(m).themeScheme,"show-tooltip":!1,class:"text-20px lt-sm:text-18px",onSwitch:o(m).toggleThemeScheme},null,8,["theme-schema","onSwitch"]),o(m).header.multilingual.visible?(h(),$(y,{key:0,lang:o(v).locale,"lang-options":o(v).localeOptions,"show-tooltip":!1,onChangeLang:o(v).changeLocale},null,8,["lang","lang-options","onChangeLang"])):D("",!0)])]),u("main",mo,[u("h3",go,I(o(l)(f.value.label)),1),u("div",fo,[e(Se,{name:o(m).page.animateMode,mode:"out-in",appear:""},{default:t(()=>[(h(),$(Pe(f.value.component)))]),_:1},8,["name"])])])])]),_:1})],4)}}});export{yo as default};
