import{aR as T,b as S,o as B,e as D,aV as H,I as O,r as _,$ as w,a$ as Y,ac as A,am as L,l as X,ar as z}from"./index-Z8DUt18u.js";import{u as G}from"./use-table-DjHicHPt.js";const J={class:"inline-block",viewBox:"0 0 32 32",width:"1em",height:"1em"};function Q(l,s){return B(),S("svg",J,s[0]||(s[0]=[D("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m23 26l-7-7l-7 7M9 6l7 7l7-7"},null,-1)]))}const te=T({name:"quill-collapse",render:Q}),U={class:"inline-block",viewBox:"0 0 32 32",width:"1em",height:"1em"};function W(l,s){return B(),S("svg",U,s[0]||(s[0]=[D("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m9 20l7 7l7-7m0-8l-7-7l-7 7"},null,-1)]))}const ne=T({name:"quill-expand",render:W});function se(l){const s=H(),y=O(),{apiFn:d,apiParams:g,immediate:p,idField:r,parentIdField:m="parentId",childrenField:h="children",defaultExpandAll:i=!1}=l,f="__selection__",k="__expand__",u=_([]),{loading:o,empty:K,data:C,columns:$,columnChecks:F,reloadColumns:v,getData:P,searchParams:R,updateSearchParams:I,resetSearchParams:N}=G({apiFn:d,apiParams:g,columns:l.columns,transformer:c=>{const n=c.data||[];if(!n.length)return{data:[]};const e=Y(n,{idField:r,parentIdField:m,childrenField:h});return u.value=i?n.map(a=>a[r]):n.filter(a=>a[m]===0).map(a=>a[r])||[],{data:e}},getColumnChecks:c=>{const n=[];return c.forEach(e=>{E(e)?n.push({key:e.key,title:e.title,checked:!0}):e.type==="selection"?n.push({key:f,title:w("common.check"),checked:!0}):e.type==="expand"&&n.push({key:k,title:w("common.expandColumn"),checked:!0})}),n},getColumns:(c,n)=>{const e=new Map;return c.forEach(t=>{E(t)?e.set(t.key,t):t.type==="selection"?e.set(f,t):t.type==="expand"&&e.set(k,t)}),n.filter(t=>t.checked).map(t=>e.get(t.key))},immediate:p});function M(c){const n=[],e=a=>{a.forEach(t=>{var b;n.push(t[r]),(b=t[h])!=null&&b.length&&e(t[h])})};return e(c),n}const{bool:V,toggle:x}=A(i);function j(){x(),u.value=M(C.value)}function q(){x(),u.value=[]}return s.run(()=>{L(()=>y.locale,()=>{v()})}),X(()=>{s.stop()}),{loading:o,empty:K,data:C,columns:$,columnChecks:F,reloadColumns:v,getData:P,searchParams:R,updateSearchParams:I,resetSearchParams:N,expandedRowKeys:u,isCollapse:V,expandAll:j,collapseAll:q}}function oe(l,s){const{bool:y,setTrue:d,setFalse:g}=A(),p=_("add");function r(){p.value="add",d()}const m=_(null);function h(o){p.value="edit",m.value=z(o),d()}const i=_([]);function f(){i.value=[]}async function k(){var o;(o=window.$message)==null||o.success(w("common.deleteSuccess")),i.value=[],await s()}async function u(){var o;(o=window.$message)==null||o.success(w("common.deleteSuccess")),await s()}return{drawerVisible:y,openDrawer:d,closeDrawer:g,operateType:p,handleAdd:r,editingData:m,handleEdit:h,checkedRowKeys:i,onBatchDeleted:k,onDeleted:u,clearCheckedRowKeys:f}}function E(l){return!!l.key}export{ne as _,oe as a,te as b,se as u};
