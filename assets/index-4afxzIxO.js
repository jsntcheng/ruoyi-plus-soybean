import{_ as he}from"./table-sider-layout-DaXxMnfX.js";import{_ as be,a as we,b as xe}from"./round-refresh-B0IUvXWI.js";import{d as q,ak as j,al as te,p as oe,a as ae,q as Ne,am as ke,c as H,o as J,ap as Ce,w as t,f as e,h as o,v as Q,ao as De,B as X,g as K,t as O,$ as v,an as Se,R as ne,N as Ie,I as Te,r as F,e as Ue,af as W,x as $e,y as Re,ab as Be,_ as Le,aq as Pe,A as Z,G as Me}from"./index-Z8DUt18u.js";import{f as ze,a as Ae,b as ee,c as Fe}from"./post-BRndancL.js";import{e as We}from"./user-BD5iFoP8.js";import{a as Ke,b as Oe,_ as Ve,u as Ee}from"./auth-CEy-eMOu.js";import{u as Ge}from"./download-4Fcgw4rI.js";import{u as je,a as qe}from"./table-xLscuIQ4.js";import{u as se}from"./dict-D3hWHJVt.js";import{_ as He}from"./dict-tag.vue_vue_type_script_setup_true_lang-C3NRfqiy.js";import{_ as Je}from"./dict-radio.vue_vue_type_script_setup_true_lang-Chn5U5qK.js";import{u as le,a as Qe,b as re,_ as Xe}from"./form-34oM_FHm.js";import{_ as Ye}from"./TreeSelect-N4Gm5Bfd.js";import{_ as ie}from"./Space-CCrTpFrl.js";import{_ as Ze}from"./Grid-tUpxGiRj.js";import{_ as et}from"./DataTable-s6EYq0ve.js";import{_ as tt}from"./Tree-C1TOTihx.js";import"./interface-CqSeKUH6.js";import"./use-table-DjHicHPt.js";import"./dict-CTAJ1fRb.js";const ot=q({name:"PostOperateDrawer",__name:"post-operate-drawer",props:j({operateType:{},rowData:{},deptData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(B,{emit:L}){const c=B,y=L,b=te(B,"visible"),{formRef:k,validate:m,restoreValidation:I}=le(),{createRequiredRule:_}=Qe(),{loading:C,startLoading:A,endLoading:d}=oe(),D=ae(()=>({add:"新增岗位信息",edit:"编辑岗位信息"})[c.operateType]),a=Ne(T());function T(){return{deptId:null,postCode:"",postCategory:"",postName:"",postSort:null,status:"0",remark:""}}const P={postId:_("岗位ID不能为空"),deptId:_("归属部门不能为空"),postCode:_("岗位编码不能为空"),postName:_("岗位名称不能为空"),postSort:_("显示顺序不能为空"),status:_("状态不能为空")};function U(){if(c.operateType==="add"){Object.assign(a,T());return}c.operateType==="edit"&&c.rowData&&(A(),Object.assign(a,c.rowData),d())}function $(){b.value=!1}async function h(){var g;if(await m(),c.operateType==="add"){const{deptId:n,postCode:w,postCategory:i,postName:f,postSort:u,status:x,remark:S}=a,{error:N}=await ze({deptId:n,postCode:w,postCategory:i,postName:f,postSort:u,status:x,remark:S});if(N)return}if(c.operateType==="edit"){const{postId:n,deptId:w,postCode:i,postCategory:f,postName:u,postSort:x,status:S,remark:N}=a,{error:M}=await Ae({postId:n,deptId:w,postCode:i,postCategory:f,postName:u,postSort:x,status:S,remark:N});if(M)return}(g=window.$message)==null||g.success(v("common.updateSuccess")),$(),y("submitted")}return ke(b,()=>{b.value&&(U(),I())}),(g,n)=>{const w=Ye,i=Xe,f=Q,u=De,x=Je,S=re,N=X,M=ie,V=Se,R=Ce;return J(),H(R,{show:b.value,"onUpdate:show":n[7]||(n[7]=l=>b.value=l),title:D.value,"display-directive":"show",width:800,class:"max-w-90%"},{default:t(()=>[e(V,{title:D.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[e(M,{size:16},{default:t(()=>[e(N,{onClick:$},{default:t(()=>[K(O(o(v)("common.cancel")),1)]),_:1}),e(N,{type:"primary",onClick:h},{default:t(()=>[K(O(o(v)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(S,{ref_key:"formRef",ref:k,model:a,rules:P},{default:t(()=>[e(i,{label:"归属部门",path:"deptId"},{default:t(()=>{var l;return[e(w,{value:a.deptId,"onUpdate:value":n[0]||(n[0]=z=>a.deptId=z),loading:o(C),clearable:"",options:g.deptData,"label-field":"label","key-field":"id","default-expanded-keys":(l=g.deptData)!=null&&l.length?[g.deptData[0].id]:[],placeholder:"请选择归属部门"},null,8,["value","loading","options","default-expanded-keys"])]}),_:1}),e(i,{label:"岗位编码",path:"postCode"},{default:t(()=>[e(f,{value:a.postCode,"onUpdate:value":n[1]||(n[1]=l=>a.postCode=l),placeholder:"请输入岗位编码"},null,8,["value"])]),_:1}),e(i,{label:"类别编码",path:"postCategory"},{default:t(()=>[e(f,{value:a.postCategory,"onUpdate:value":n[2]||(n[2]=l=>a.postCategory=l),placeholder:"请输入类别编码"},null,8,["value"])]),_:1}),e(i,{label:"岗位名称",path:"postName"},{default:t(()=>[e(f,{value:a.postName,"onUpdate:value":n[3]||(n[3]=l=>a.postName=l),placeholder:"请输入岗位名称"},null,8,["value"])]),_:1}),e(i,{label:"显示顺序",path:"postSort"},{default:t(()=>[e(u,{value:a.postSort,"onUpdate:value":n[4]||(n[4]=l=>a.postSort=l),placeholder:"请输入显示顺序"},null,8,["value"])]),_:1}),e(i,{label:"状态",path:"status"},{default:t(()=>[e(x,{value:a.status,"onUpdate:value":n[5]||(n[5]=l=>a.status=l),"dict-code":"sys_normal_disable"},null,8,["value"])]),_:1}),e(i,{label:"备注",path:"remark"},{default:t(()=>[e(f,{value:a.remark,"onUpdate:value":n[6]||(n[6]=l=>a.remark=l),rows:3,type:"textarea",placeholder:"请输入备注"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show","title"])}}}),at=q({name:"PostSearch",__name:"post-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(B,{emit:L}){const c=L,{formRef:y,validate:b,restoreValidation:k}=le(),m=te(B,"model"),{options:I}=se("sys_normal_disable");async function _(){await k(),c("reset")}async function C(){await b(),c("search")}return(A,d)=>{const D=Q,a=Oe,T=Ie,P=be,U=X,$=we,h=ie,g=Ze,n=re,w=Ke,i=Ve,f=ne;return J(),H(f,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(i,null,{default:t(()=>[e(w,{title:o(v)("common.search"),name:"user-search"},{default:t(()=>[e(n,{ref_key:"formRef",ref:y,model:m.value,"label-placement":"left","label-width":80},{default:t(()=>[e(g,{responsive:"screen","item-responsive":""},{default:t(()=>[e(a,{span:"6 s:12 m:6",label:"岗位编码",path:"postCode",class:"pr-24px"},{default:t(()=>[e(D,{value:m.value.postCode,"onUpdate:value":d[0]||(d[0]=u=>m.value.postCode=u),placeholder:"请输入岗位编码"},null,8,["value"])]),_:1}),e(a,{span:"6 s:12 m:6",label:"岗位名称",path:"postName",class:"pr-24px"},{default:t(()=>[e(D,{value:m.value.postName,"onUpdate:value":d[1]||(d[1]=u=>m.value.postName=u),placeholder:"请输入岗位名称"},null,8,["value"])]),_:1}),e(a,{span:"6 s:12 m:6",label:"状态",path:"status",class:"pr-24px"},{default:t(()=>[e(T,{value:m.value.status,"onUpdate:value":d[2]||(d[2]=u=>m.value.status=u),placeholder:"请选择状态",options:o(I),clearable:""},null,8,["value","options"])]),_:1}),e(a,{span:"6",class:"pr-24px"},{default:t(()=>[e(h,{class:"w-full",justify:"end"},{default:t(()=>[e(U,{onClick:_},{icon:t(()=>[e(P,{class:"text-icon"})]),default:t(()=>[K(" "+O(o(v)("common.reset")),1)]),_:1}),e(U,{type:"primary",ghost:"",onClick:C},{icon:t(()=>[e($,{class:"text-icon"})]),default:t(()=>[K(" "+O(o(v)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1})]),_:1})}}}),nt={class:"h-full flex-col-stretch gap-12px overflow-hidden lt-sm:overflow-auto"},st=q({name:"system_post",__name:"index",setup(B){se("sys_normal_disable");const L=Te(),{download:c}=Ge(),{hasAuth:y}=Ee(),{columns:b,columnChecks:k,data:m,getData:I,getDataByPage:_,loading:C,mobilePagination:A,searchParams:d,resetSearchParams:D}=je({apiFn:Fe,apiParams:{pageNum:1,pageSize:10,postCode:null,postName:null,status:null,belongDeptId:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:v("common.index"),align:"center",width:64},{key:"postCode",title:"岗位编码",align:"center",minWidth:120},{key:"postCategory",title:"类别编码",align:"center",minWidth:120},{key:"postName",title:"岗位名称",align:"center",minWidth:120},{key:"postSort",title:"显示顺序",align:"center",minWidth:120},{key:"status",title:"状态",align:"center",minWidth:120,render(r){return e(He,{size:"small",value:r.status,dictCode:"sys_normal_disable"},null)}},{key:"createTime",title:"创建时间",align:"center",minWidth:120,ellipsis:{tooltip:!0}},{key:"operate",title:v("common.operate"),align:"center",width:130,render:r=>{const s=()=>!y("system:post:edit")||!y("system:post:remove")?null:e(Pe,{vertical:!0},null),E=()=>y("system:post:edit")?e(Z,{type:"primary",text:!0,icon:"material-symbols:drive-file-rename-outline-outline",tooltipContent:v("common.edit"),onClick:()=>f(r.postId)},null):null,G=()=>y("system:post:remove")?e(Z,{text:!0,type:"error",icon:"material-symbols:delete-outline",tooltipContent:v("common.delete"),popconfirmContent:v("common.confirmDelete"),onPositiveClick:()=>i(r.postId)},null):null;return e("div",{class:"flex-center gap-8px"},[E(),s(),G()])}}]}),{drawerVisible:a,operateType:T,editingData:P,handleAdd:U,handleEdit:$,checkedRowKeys:h,onBatchDeleted:g,onDeleted:n}=qe(m,I);async function w(){const{error:r}=await ee(h.value);r||g()}async function i(r){const{error:s}=await ee([r]);s||n()}async function f(r){$("postId",r)}async function u(){c("/system/post/export",d,`岗位信息_${new Date().getTime()}.xlsx`)}const x=F([100]),S=ae(()=>!C.value),{loading:N,startLoading:M,endLoading:V}=oe(),R=F(),l=F([]),z=F([]);async function Y(){M();const{data:r,error:s}=await We();s||(l.value=r),V()}Y();function pe(r){d.belongDeptId=r.length?r[0]:null,h.value=[],_()}function de(){R.value=void 0,Y()}function ue(){D(),z.value=[]}return(r,s)=>{const E=Le,G=Q,ce=Re,me=tt,_e=$e,fe=xe,ve=et,ye=ne,ge=he;return J(),H(ge,{"sider-title":"部门列表"},{"header-extra":t(()=>[e(o(X),{size:"small",text:"",class:"h-18px",onClick:s[0]||(s[0]=Be(()=>de(),["stop"]))},{icon:t(()=>[e(E,{icon:"ic:round-refresh"})]),_:1})]),sider:t(()=>[e(G,{value:R.value,"onUpdate:value":s[1]||(s[1]=p=>R.value=p),clearable:"",placeholder:o(v)("common.keywordSearch")},null,8,["value","placeholder"]),e(_e,{class:"dept-tree",show:o(N)},{default:t(()=>[e(me,{"expanded-keys":x.value,"onUpdate:expandedKeys":s[2]||(s[2]=p=>x.value=p),"selected-keys":z.value,"onUpdate:selectedKeys":[s[3]||(s[3]=p=>z.value=p),pe],"block-node":"","show-line":"",data:l.value,"show-irrelevant-nodes":!1,pattern:R.value,"block-line":"",class:"infinite-scroll h-full min-h-200px py-3","key-field":"id","label-field":"label","virtual-scroll":"",selectable:S.value},{empty:t(()=>[e(ce,{description:"暂无部门信息",class:"h-full min-h-200px justify-center"})]),_:1},8,["expanded-keys","selected-keys","data","pattern","selectable"])]),_:1},8,["show"])]),default:t(()=>[Ue("div",nt,[e(at,{model:o(d),"onUpdate:model":s[4]||(s[4]=p=>W(d)?d.value=p:null),onReset:ue,onSearch:o(_)},null,8,["model","onSearch"]),e(ye,{title:"岗位信息列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(fe,{columns:o(k),"onUpdate:columns":s[5]||(s[5]=p=>W(k)?k.value=p:null),"disabled-delete":o(h).length===0,loading:o(C),"show-add":o(y)("system:post:add"),"show-delete":o(y)("system:post:remove"),"show-export":o(y)("system:post:export"),onAdd:o(U),onDelete:w,onExport:u,onRefresh:o(I)},null,8,["columns","disabled-delete","loading","show-add","show-delete","show-export","onAdd","onRefresh"])]),default:t(()=>[e(ve,{"checked-row-keys":o(h),"onUpdate:checkedRowKeys":s[6]||(s[6]=p=>W(h)?h.value=p:null),columns:o(b),data:o(m),size:"small","flex-height":!o(L).isMobile,"scroll-x":962,loading:o(C),remote:"","row-key":p=>p.postId,pagination:o(A),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(ot,{visible:o(a),"onUpdate:visible":s[7]||(s[7]=p=>W(a)?a.value=p:null),"operate-type":o(T),"row-data":o(P),"dept-data":l.value,onSubmitted:o(_)},null,8,["visible","operate-type","row-data","dept-data","onSubmitted"])]),_:1})])]),_:1})}}}),Dt=Me(st,[["__scopeId","data-v-8a11f844"]]);export{Dt as default};
